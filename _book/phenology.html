<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="18 Phenology | Data Science for the Natural Environment (FA21)" />
<meta property="og:type" content="book" />





<meta name="author" content="Shannon J. O’Leary" />

<meta name="date" content="2021-10-14" />


<meta name="description" content="18 Phenology | Data Science for the Natural Environment (FA21)">

<title>18 Phenology | Data Science for the Natural Environment (FA21)</title>

<script src="libs/header-attrs/header-attrs.js"></script>
<link href="libs/tufte-css/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css/msmb.css" rel="stylesheet" />
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/plotly-binding/plotly.js"></script>
<script src="libs/typedarray/typedarray.min.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main/plotly-latest.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="msmb.css" type="text/css" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script>
function copy_link(id) {
  var dummy = document.createElement('input'),
  text = window.location.href.split(/[?#]/)[0] + '#' + id;
  document.body.appendChild(dummy);
  dummy.value = text;
  dummy.select();
  document.execCommand('copy');
  document.body.removeChild(dummy);
  
  var tooltip = document.getElementById(id + '-tooltip');
  tooltip.innerHTML = 'Copied!';
}

function reset_tooltip(id) {
  var tooltip = document.getElementById(id);
  tooltip.innerHTML = 'Copy link';
}
</script>

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Data Science for the Natural Environment (FA21)<p><p class="author">Shannon J. O'Leary</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Overview</a>
<a href="what-even-is-data-science.html"><span class="toc-section-number">1</span> What even is data science?</a>
<a href="installing-rrstudio.html"><span class="toc-section-number">2</span> Installing R/Rstudio</a>
<a href="project-management-and-rmarkdown-basics.html"><span class="toc-section-number">3</span> Project management and Rmarkdown Basics</a>
<a href="r-functions-objects-vectors---oh-my.html"><span class="toc-section-number">4</span> R: Functions, Objects, Vectors - oh my!</a>
<a href="identifying-essential-fish-habitat-shark-nurseries-on-the-texas-coast.html"><span class="toc-section-number">5</span> Identifying essential fish habitat: Shark Nurseries on the Texas coast</a>
<a href="intro-to-data-frames.html"><span class="toc-section-number">6</span> Intro to data frames</a>
<a href="welcome-to-the-tidyverse.html"><span class="toc-section-number">7</span> Welcome to the tidyverse</a>
<a href="catch-data-analysis.html"><span class="toc-section-number">8</span> Catch data analysis</a>
<a href="scientific-misconduct-and-the-reproducible-crisis.html"><span class="toc-section-number">9</span> Scientific misconduct and the reproducible crisis</a>
<a href="responsible-research-is-reproducible-research.html"><span class="toc-section-number">10</span> Responsible Research is Reproducible Research</a>
<a href="project-management-revisited.html"><span class="toc-section-number">11</span> Project Management Revisited</a>
<a href="data-wrangling-tidy-data-revisited.html"><span class="toc-section-number">12</span> Data Wrangling &amp; Tidy data Revisited</a>
<a href="climate-change.html"><span class="toc-section-number">13</span> Climate Change</a>
<a href="visualization.html"><span class="toc-section-number">14</span> Visualization</a>
<a href="visualizations-as-a-tool-for-misinformation.html"><span class="toc-section-number">15</span> Visualizations as a tool for misinformation</a>
<a href="exploratory-analysis.html"><span class="toc-section-number">16</span> Exploratory Analysis</a>
<a href="making-good-figures.html"><span class="toc-section-number">17</span> Making good figures</a>
<a id="active-page" href="phenology.html"><span class="toc-section-number">18</span> Phenology</a><ul class="toc-sections">
<li class="toc"><a href="#introduction-to-phenology"> Introduction to phenology</a></li>
<li class="toc"><a href="#explore-the-data-set-1"> Explore the data set</a></li>
<li class="toc"><a href="#formulate-a-specific-question"> Formulate a specific question</a></li>
<li class="toc"><a href="#determine-changes-in-the-flowering-date-of-american-elm-in-ramsey-county-mn"> Determine changes in the flowering date of American elm in Ramsey County, MN</a></li>
<li class="toc"><a href="#determine-temperature-change-in-ramsey-county"> Determine temperature change in Ramsey County</a></li>
</ul>
<a href="references.html">References</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div id="phenology" class="section level1" number="18">
<h1>
<span class="header-section-number">18</span> Phenology</h1>
<p><strong>Learning Objectives</strong></p>
<p>After completing this tutorial you should be able to</p>
<ul>
<li>formulate meaningful questions based on a given data set</li>
<li>run a linear regression analysis using the <code>tidymodels</code> framework</li>
<li>understand potential impacts of climate change on the phenology of species</li>
</ul>
<p>Download the <a href="https://drive.google.com/drive/folders/19GD1COEgPPfjtXrfzKFoLodzdH0a-v68?usp=sharing">05_Phenology</a> project folder. Once you have downloaded it, unzip the project directory into your <code>BI449</code> directory.</p>
<p>To get some practice setting up your own project files, you might notice that this one does not yet have an <code>Rproj</code> file or any <code>Rmarkdown</code> files in it. So the first thing we want to do is create a new R project. To do this open <code>Rstudio</code> then use the dropdown menu in the top right corner to select <code>New Project</code> and from there <code>New Project in an existing directory</code>. From there, navigate to and select the project folder create an R project.</p>
<p>Open a new <code>Rmd</code> file using <code>File &gt; New File &gt; R Markdown</code> or the drop down menu of the green plus button below <code>File</code> and save it in your Exploratory Analysis project directory. That’s right - training wheels are off … you will need to add all of your own headers, plain text etc. Set up the <code>YAML</code> header so that you are the author and when knitted the date will reflect the date of the creation of the document.</p>
<p>Recall that you can use the initial setup chunk to set some of your preferred formatting by determining global settings for the document. One helpful setting we discovered is to turn off warnings, errors, and messages being printed out in the knitted html document.</p>
<p>Another helpful setting is to define a default theme for your plots. You can do this using <code>theme_set()</code>. So for example, you could set a default theme like so: <code>theme_set(theme_bw())</code>. Choose your favorite theme (or try a new one) for this homework assignment.</p>
<p>Remember, you should always check your <code>html</code> document after it knits to make sure that everything has converted as expected, including your figures, bullet points etc.</p>
<p>Let’s load our packages so we can get started.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="phenology.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries</span></span>
<span id="cb334-2"><a href="phenology.html#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb334-3"><a href="phenology.html#cb334-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb334-4"><a href="phenology.html#cb334-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb334-5"><a href="phenology.html#cb334-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb334-6"><a href="phenology.html#cb334-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb334-7"><a href="phenology.html#cb334-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb334-8"><a href="phenology.html#cb334-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-9"><a href="phenology.html#cb334-9" aria-hidden="true" tabindex="-1"></a><span class="co"># turn of sci notation</span></span>
<span id="cb334-10"><a href="phenology.html#cb334-10" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span></code></pre></div>
<div id="introduction-to-phenology" class="section level2" number="18.1">
<h2>
<span class="header-section-number">18.1</span> Introduction to phenology<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('introduction-to-phenology')" onmouseout="reset_tooltip('introduction-to-phenology-tooltip')"><span class="tooltiptext" id="introduction-to-phenology-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<div id="ques:phen-1" class="question">
<p class="question-begin">
► Question 18.1
</p>
<div class="question-body">
<p>Briefly define the terms phenology, phenophases, life history and life history traits and argue how you think climate change might impact these.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>We are going to explore a data set that contains information on the phenology of Minnesota Species to determine to which extent seasonal events are tied to climate or whether they are dependent on other factors. To do this we are going to use a data set generated by the <a href="https://mnpn.usanpn.org/">Minnesota Phenology Network</a>.</p>
<div id="ques:phen-2" class="question">
<p class="question-begin">
► Question 18.2
</p>
<div class="question-body">
<p>Go to the Minnesota Phenological Network’s website and explore the short introductory and history statements in the “Home” and “About” sections. Check out the “Meet the species” page that presents Minnesota’s seven superstar species. Get to know them in the “Read more” sections.</p>
<p>Pick two of the seven superstars and list the specific phenophases that associated with the species.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="explore-the-data-set-1" class="section level2" number="18.2">
<h2>
<span class="header-section-number">18.2</span> Explore the data set<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('explore-the-data-set-1')" onmouseout="reset_tooltip('explore-the-data-set-1-tooltip')"><span class="tooltiptext" id="explore-the-data-set-1-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>We are going to use data from the Minnesota Phenology Network to explore how climate change might be impacting the phenology of species.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="phenology.html#cb335-1" aria-hidden="true" tabindex="-1"></a>pheno <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"data/mnpn_master_dataset_2018.v2.txt"</span>, <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb335-2"><a href="phenology.html#cb335-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code></pre></div>
<div id="ques:phen-3" class="question">
<p class="question-begin">
► Question 18.3
</p>
<div class="question-body">
<p>Let’s get an overview of the data set. Use your exploratory analysis skills to get an idea of the dimensions of the data set, what variables are contained in the data set and what data types they are. What function can you use?</p>
<p>Write a brief description of the data set.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-31" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-31', 'sol-start-31')"></span>
</p>
<div id="sol-body-31" class="solution-body" style="display: none;">
<p>That’s right - <code>skim()</code> will give you all the information in one handy place!</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="phenology.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(pheno)</span></code></pre></div>
<p><!--
<caption>--><span class="marginnote shownote"><span id="tab:unnamed-chunk-275">Table 18.1: </span>Data summary</span><!--</caption>--></p>
<table><tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">pheno</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">54741</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">12</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">9</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody></table>
<p><strong>Variable type: character</strong></p>
<table>
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">day</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">4329</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">event</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">4</td>
<td align="right">36</td>
<td align="right">0</td>
<td align="right">120</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">species_common_name</td>
<td align="right">136</td>
<td align="right">1.00</td>
<td align="right">3</td>
<td align="right">48</td>
<td align="right">0</td>
<td align="right">1827</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">genus</td>
<td align="right">594</td>
<td align="right">0.99</td>
<td align="right">3</td>
<td align="right">15</td>
<td align="right">0</td>
<td align="right">748</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">species</td>
<td align="right">1566</td>
<td align="right">0.97</td>
<td align="right">2</td>
<td align="right">24</td>
<td align="right">0</td>
<td align="right">1089</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">county</td>
<td align="right">83</td>
<td align="right">1.00</td>
<td align="right">2</td>
<td align="right">17</td>
<td align="right">0</td>
<td align="right">43</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">lifeform</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">6</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">group</td>
<td align="right">136</td>
<td align="right">1.00</td>
<td align="right">4</td>
<td align="right">22</td>
<td align="right">0</td>
<td align="right">17</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">invasive</td>
<td align="right">53339</td>
<td align="right">0.03</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead><tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1997.56</td>
<td align="right">16.53</td>
<td align="right">1941</td>
<td align="right">1986</td>
<td align="right">2004</td>
<td align="right">2011</td>
<td align="right">2017</td>
<td align="left">▁▂▂▂▇</td>
</tr>
<tr class="even">
<td align="left">dataset</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6.56</td>
<td align="right">4.46</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">12</td>
<td align="right">13</td>
<td align="left">▇▃▅▁▇</td>
</tr>
<tr class="odd">
<td align="left">day_of_year</td>
<td align="right">84</td>
<td align="right">1</td>
<td align="right">173.95</td>
<td align="right">58.82</td>
<td align="right">2</td>
<td align="right">130</td>
<td align="right">164</td>
<td align="right">211</td>
<td align="right">366</td>
<td align="left">▁▇▇▃▁</td>
</tr>
</tbody>
</table>
<p>You still have to write your description though …</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>One thing you may have noticed is that we have a column <code>day</code> that contains the data - however, currently it is formatted as a <code>character</code>. This could cause issues down the line when we want to plot things.</p>
<p>Dates are notoriously difficult to deal with<label for="tufte-sn-102" class="margin-toggle sidenote-number">102</label><input type="checkbox" id="tufte-sn-102" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">102</span> just think of the many, many, many ways we can write a date and how conventions might differ between fields and countries!</span>. A useful package to deal with dates is <code>lubridate</code>.</p>
<p>Let’s use functions from that package to create column called <code>data</code> that has the data type date, and while where at it learn how to create new columns with the month and day.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="phenology.html#cb337-1" aria-hidden="true" tabindex="-1"></a>pheno <span class="ot">&lt;-</span> pheno <span class="sc">%&gt;%</span></span>
<span id="cb337-2"><a href="phenology.html#cb337-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">mdy</span>(day),            <span class="co"># converts character in format month day year to date</span></span>
<span id="cb337-3"><a href="phenology.html#cb337-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">month =</span> <span class="fu">month</span>(date),        <span class="co"># extract month</span></span>
<span id="cb337-4"><a href="phenology.html#cb337-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">day =</span> <span class="fu">day</span>(date))            <span class="co"># extract day</span></span></code></pre></div>
<p>Now let’s get an idea on what data is contained in the data set.</p>
<div id="ques:phen-4" class="question">
<p class="question-begin">
► Question 18.4
</p>
<div class="question-body">
<p>How can you use the <code>skimr</code> output to determine how many unique entries (categories) we have for our categorical variables?</p>
<p>What function could you use to determine what life forms, groups of species, and counties are contained in the data set?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-32" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-32', 'sol-start-32')"></span>
</p>
<div id="sol-body-32" class="solution-body" style="display: none;">
<p>The <code>dplyr</code> verb that can help you out here is <code>distinct()</code> - go ahead and create those tables.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:phen-5" class="question">
<p class="question-begin">
► Question 18.5
</p>
<div class="question-body">
<p>Create a table that shows the number of species in each group of species.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Let’s focus on woody plants for now.</p>
<div id="ques:phen-6" class="question">
<p class="question-begin">
► Question 18.6
</p>
<div class="question-body">
<p>Create a new object called <code>woody</code> that contains only woody plants.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:phen-7" class="question">
<p class="question-begin">
► Question 18.7
</p>
<div class="question-body">
<p>Determine what events are recorded for species in this category. Create an overview table with events organized alphabetically.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>That’s a lot of events.</p>
<div id="ques:phen-8" class="question">
<p class="question-begin">
► Question 18.8
</p>
<div class="question-body">
<p>Let’s try to get an idea of when these different events occur throughout the year. How could you plot this data? Give it a try!</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-33" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-33', 'sol-start-33')"></span>
</p>
<div id="sol-body-33" class="solution-body" style="display: none;">
<p>Since we are interested in distributions, you would want to look at histograms or boxplots - this is one way your figure could look like:</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="phenology.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(woody, <span class="fu">aes</span>(<span class="at">x =</span> day_of_year, <span class="at">y =</span> event)) <span class="sc">+</span></span>
<span id="cb338-2"><a href="phenology.html#cb338-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"darkorange"</span>) <span class="sc">+</span></span>
<span id="cb338-3"><a href="phenology.html#cb338-3" aria-hidden="true" tabindex="-1"></a>  theme_standard</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-278"></span>
<p class="caption marginnote shownote">
Figure 18.1: Distribution of life history events throughout the year for Minnesota woody plants. echo=FALSE
</p>
<img src="_main_files/figure-html/unnamed-chunk-278-1.png" alt="Distribution of life history events throughout the year for Minnesota woody plants. echo=FALSE" width="672">
</div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="formulate-a-specific-question" class="section level2" number="18.3">
<h2>
<span class="header-section-number">18.3</span> Formulate a specific question<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('formulate-a-specific-question')" onmouseout="reset_tooltip('formulate-a-specific-question-tooltip')"><span class="tooltiptext" id="formulate-a-specific-question-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Since we are interested in whether climate change is impacting phenology, let’s chose a specific event that we think is likely to be linked to changes in temperature and could be a good indicator of changing phenology.</p>
<div id="ques:phen-9" class="question">
<p class="question-begin">
► Question 18.9
</p>
<div class="question-body">
<p>Pick three events that you think could be good indicator events to look at and argue why you think they would be interesting to explore.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Let’s use flowering date.</p>
<div id="ques:phen-10" class="question">
<p class="question-begin">
► Question 18.10
</p>
<div class="question-body">
<p>Create a subset called <code>flowering</code> that contains only records of flowering dates for woody plants. How could you plot this data to determine whether the flowering data has changed over time?</p>
<p>Describe how you expect the pattern to look like if the flowering date is occurring earlier, later, or not changing over time.</p>
<p>Plot the data and then use your predicted patterns to assess whether the flowering date is changing over time.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-34" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-34', 'sol-start-34')"></span>
</p>
<div id="sol-body-34" class="solution-body" style="display: none;">
<p>This is what you want your figure to look like:</p>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-280"></span>
<p class="caption marginnote shownote">
Figure 18.2: Change in day of flowering for woody plants in Minnesota 1941 - 2018. Fill of individual points indicates the month of the flowering date, Linear trendline is fitted in red.
</p>
<img src="_main_files/figure-html/unnamed-chunk-280-1.png" alt="Change in day of flowering for woody plants in Minnesota 1941 - 2018. Fill of individual points indicates the month of the flowering date, Linear trendline is fitted in red." width="672">
</div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Let’s consider how useful this visualization is for answering our question. We combined all the woody species from all of Minnesota in the same plot. We probably don’t expect all the woody plants to react to changes in the same way or for that response to occur at the same pace. We should also consider that there could be differences based on the geographic location.</p>
<p>In this case, it might be more effective to narrow our question and pull out a specific species. Let’s use the American Elm (<em>Ulmus americanus</em>). This is a deciduous species with a geographic range throughout most of the eastern US and southeast Canada, i.e. Minnesota is at the northern limit of its range. Overall, this is a pretty hardy species that will grow to a considerable size and is frequently found in Urban settings. Like all elm species in Minnesota it is susceptible to the Dutch elm disease which caused by an invasive fungal pathogen.</p>
<div id="ques:phen-11" class="question">
<p class="question-begin">
► Question 18.11
</p>
<div class="question-body">
<p>Create a new object called <code>elm</code> that contains only entries for the American Elm.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Since the American Elm is so widespread, let’s also consider that we might want to eliminate geography as a confounding pattern.</p>
<div id="ques:phen-12" class="question">
<p class="question-begin">
► Question 18.12
</p>
<div class="question-body">
<p>Determine whether we have data for more than one county. Use that information to determine whether you want (need) to narrow down your data set. Explain your choice.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>It appears we have found our question!</p>
<div id="ques:phen-13" class="question">
<p class="question-begin">
► Question 18.13
</p>
<div class="question-body">
<p>State the specific question we are asking and give a brief description of the data you will need and how you will analyze it to answer that question.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-35" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-35', 'sol-start-35')"></span>
</p>
<div id="sol-body-35" class="solution-body" style="display: none;">
<p>Just so we are all in agreement - our question is: Has climate change changed the phenology of American Elm in Ramsey County, Minnesota?</p>
<p>But do we already have all the data we need?</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="determine-changes-in-the-flowering-date-of-american-elm-in-ramsey-county-mn" class="section level2" number="18.4">
<h2>
<span class="header-section-number">18.4</span> Determine changes in the flowering date of American elm in Ramsey County, MN<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('determine-changes-in-the-flowering-date-of-american-elm-in-ramsey-county-mn')" onmouseout="reset_tooltip('determine-changes-in-the-flowering-date-of-american-elm-in-ramsey-county-mn-tooltip')"><span class="tooltiptext" id="determine-changes-in-the-flowering-date-of-american-elm-in-ramsey-county-mn-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Our first step will be determining whether or not there has been a change in the flowering data of the American Elm.</p>
<div id="ques:phen-14" class="question">
<p class="question-begin">
► Question 18.14
</p>
<div class="question-body">
<p>Make a prediction of how you think the flowering date of the American Elm may have changed over the 50 year time span recorded in our data set. Describe what your figure should look like if you are indeed correct, be specific and argue why you are expecting this pattern.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:phen-15" class="question">
<p class="question-begin">
► Question 18.15
</p>
<div class="question-body">
<p>Filter your data so that it only contains entries for Ramsey Country.</p>
<p>Plot your data to determine if your prediction was correct; add a simple linear trend line to your plot to help identify the overall pattern.</p>
<p>Give your visualization a title and legend and describe your results. Be specific, i.e. consider how much the flowering data has shifted. For your interpretation/discussion identify at least two possible mechanisms that could be causing this pattern.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-36" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-36', 'sol-start-36')"></span>
</p>
<div id="sol-body-36" class="solution-body" style="display: none;">
<p>This is what your figure should look like.</p>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-282"></span>
<p class="caption marginnote shownote">
Figure 18.3: Change in flowering data for American Elm in Ramsey Co., MN (1941 - 1991). Fill of individual points indicates the month of the flowering date, the linear trendline is indicated in red.
</p>
<img src="_main_files/figure-html/unnamed-chunk-282-1.png" alt="Change in flowering data for American Elm in Ramsey Co., MN  (1941 - 1991). Fill of individual points indicates the month of the flowering date, the linear trendline is indicated in red." width="672">
</div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="determine-temperature-change-in-ramsey-county" class="section level2" number="18.5">
<h2>
<span class="header-section-number">18.5</span> Determine temperature change in Ramsey County<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('determine-temperature-change-in-ramsey-county')" onmouseout="reset_tooltip('determine-temperature-change-in-ramsey-county-tooltip')"><span class="tooltiptext" id="determine-temperature-change-in-ramsey-county-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>If we want to investigate whether there is a relationship between climate change and change in the flowering date, we need climate data for Ramsey Country for the same time period.</p>
<div id="ques:phen-16" class="question">
<p class="question-begin">
► Question 18.16
</p>
<div class="question-body">
<p>Describe what your climate data set should look like and argue why you want to include certain variables. Describe the pattern you would expect to see in your climate data over time to support your hypothesis of what is driving the pattern you uncovered in the phenology data set. Be specific.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-37" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-37', 'sol-start-37')"></span>
</p>
<div id="sol-body-37" class="solution-body" style="display: none;">
<p>Hint: Consider what the ideal temporal and spatial resolution would need to be to “match” your phenology data.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>You ask and you shall receive:</p>
<p>Go to the DNR <a href="https://arcgis.dnr.state.mn.us/ewr/climatetrends/">Minnesota Climate Trends</a> website to access historical observations for specific Minnesota locations. Use the drop down menus options to select subsets using the check boxes to create a data set that meets the specifications you set out above.</p>
<p>Unfortunately, the download button doesn’t work. Instead, you should cut and paste the data into a text editor or excel and save it as a tab-delimited file in your <code>data</code> folder. Name it <code>MN_temp.txt</code>.</p>
<p>Lets read in your temperature data. Unless you added headers in the text file it’s missing them. Similar to the way we can use <code>skip</code> if there are additional lines, we have an argument we can use to specify column names if they are missing.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="phenology.html#cb339-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"data/MN_temp.txt"</span>, <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"temperature"</span>))</span></code></pre></div>
<div id="ques:phen-17" class="question">
<p class="question-begin">
► Question 18.17
</p>
<div class="question-body">
<p>Plot your data to determine if your prediction was correct; add a simple linear trend line to your plot to help identify the overall pattern.</p>
<p>Give your visualization a title and legend and describe your results. Be specific (i.e. don’t just state the overall trend, consider how much temperature has changed). For your interpretation/discussion consider how the data differs from your predictions and determine whether it supports your hypothesis of the mechanism.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-38" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-38', 'sol-start-38')"></span>
</p>
<div id="sol-body-38" class="solution-body" style="display: none;">
<p>Here’s what your figure could look like:</p>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-284"></span>
<p class="caption marginnote shownote">
Figure 18.4: Change in mean March temperature [Fahrenheit] for 1941 - 1991 (blue) and linear trendline (red)
</p>
<img src="_main_files/figure-html/unnamed-chunk-284-1.png" alt="Change in mean March temperature [Fahrenheit] for 1941 - 1991 (blue) and linear trendline (red)" width="672">
</div>
<p>Bonus question: Consider why it might be appropriate to use a line graph for the temperature data but not for the flowering date plot.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>

</div>
</div></body></html>

<p style="text-align: center;">
<a href="making-good-figures.html"><button class="btn btn-default">Previous</button></a>
<a href="references.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2021-10-14
 using 
R version 4.0.2 (2020-06-22)
</p>
</div>
</div>



</body>
</html>

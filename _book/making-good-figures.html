<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="17 Making good figures | Data Science for the Natural Environment (FA21)" />
<meta property="og:type" content="book" />





<meta name="author" content="Shannon J. O’Leary" />

<meta name="date" content="2021-11-15" />


<meta name="description" content="17 Making good figures | Data Science for the Natural Environment (FA21)">

<title>17 Making good figures | Data Science for the Natural Environment (FA21)</title>

<script src="libs/header-attrs/header-attrs.js"></script>
<link href="libs/tufte-css/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css/msmb.css" rel="stylesheet" />
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/plotly-binding/plotly.js"></script>
<script src="libs/typedarray/typedarray.min.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main/plotly-latest.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="msmb.css" type="text/css" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script>
function copy_link(id) {
  var dummy = document.createElement('input'),
  text = window.location.href.split(/[?#]/)[0] + '#' + id;
  document.body.appendChild(dummy);
  dummy.value = text;
  dummy.select();
  document.execCommand('copy');
  document.body.removeChild(dummy);
  
  var tooltip = document.getElementById(id + '-tooltip');
  tooltip.innerHTML = 'Copied!';
}

function reset_tooltip(id) {
  var tooltip = document.getElementById(id);
  tooltip.innerHTML = 'Copy link';
}
</script>

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Data Science for the Natural Environment (FA21)<p><p class="author">Shannon J. O'Leary</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Overview</a>
<a href="what-even-is-data-science.html"><span class="toc-section-number">1</span> What even is data science?</a>
<a href="installing-rrstudio.html"><span class="toc-section-number">2</span> Installing R/Rstudio</a>
<a href="project-management-and-rmarkdown-basics.html"><span class="toc-section-number">3</span> Project management and Rmarkdown Basics</a>
<a href="r-functions-objects-vectors---oh-my.html"><span class="toc-section-number">4</span> R: Functions, Objects, Vectors - oh my!</a>
<a href="identifying-essential-fish-habitat-shark-nurseries-on-the-texas-coast.html"><span class="toc-section-number">5</span> Identifying essential fish habitat: Shark Nurseries on the Texas coast</a>
<a href="intro-to-data-frames.html"><span class="toc-section-number">6</span> Intro to data frames</a>
<a href="welcome-to-the-tidyverse.html"><span class="toc-section-number">7</span> Welcome to the tidyverse</a>
<a href="catch-data-analysis.html"><span class="toc-section-number">8</span> Catch data analysis</a>
<a href="scientific-misconduct-and-the-reproducible-crisis.html"><span class="toc-section-number">9</span> Scientific misconduct and the reproducible crisis</a>
<a href="responsible-research-is-reproducible-research.html"><span class="toc-section-number">10</span> Responsible Research is Reproducible Research</a>
<a href="project-management-revisited.html"><span class="toc-section-number">11</span> Project Management Revisited</a>
<a href="data-wrangling-tidy-data-revisited.html"><span class="toc-section-number">12</span> Data Wrangling &amp; Tidy data Revisited</a>
<a href="climate-change.html"><span class="toc-section-number">13</span> Climate Change</a>
<a href="visualization.html"><span class="toc-section-number">14</span> Visualization</a>
<a href="visualizations-as-a-tool-for-misinformation.html"><span class="toc-section-number">15</span> Visualizations as a tool for misinformation</a>
<a href="exploratory-analysis.html"><span class="toc-section-number">16</span> Exploratory Analysis</a>
<a id="active-page" href="making-good-figures.html"><span class="toc-section-number">17</span> Making good figures</a><ul class="toc-sections">
<li class="toc"><a href="#best-practices-for-effective-figures"> Best practices for effective figures</a></li>
<li class="toc"><a href="#best-practices-for-communicating-results"> Best practices for communicating results</a></li>
<li class="toc"><a href="#practice-the-best-practices"> Practice the best practices!</a></li>
<li class="toc"><a href="#spatial-visualization"> Spatial visualization</a></li>
</ul>
<a href="phenology.html"><span class="toc-section-number">18</span> Phenology</a>
<a href="predictive-modeling.html"><span class="toc-section-number">19</span> Predictive Modeling</a>
<a href="remote-sensing.html"><span class="toc-section-number">20</span> Remote Sensing</a>
<a href="simulated-data-for-hypothesis-testing-i.html"><span class="toc-section-number">21</span> Simulated Data for hypothesis testing I</a>
<a href="simulated-data-for-hypothesis-testing-ii.html"><span class="toc-section-number">22</span> Simulated Data for hypothesis testing II</a>
<a href="references.html">References</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div id="making-good-figures" class="section level1" number="17">
<h1>
<span class="header-section-number">17</span> Making good figures</h1>
<p><strong>Learning Objectives</strong></p>
<p>After completing this tutorial you should be able to</p>
<ul>
<li>describe detailed characteristics of a figure that is clear, accessible, transparent, and honest.</li>
<li>describe characteristics of an effective figure legend.</li>
<li>describe characteristics of an effective description of results.</li>
<li>describe characteristics of an effective interpretation/discussion of central results.</li>
</ul>
<p>Open a new <code>Rmd</code> file using <code>File &gt; New File &gt; R Markdown</code> or the drop down menu of the green plus button below <code>File</code> and save it in your Exploratory Analysis project directory. That’s right - training wheels are off … you will need to add all of your own headers, plain text etc. Set up the <code>YAML</code> header so that you are the author and when knitted the date will reflect the date of the creation of the document and create settings for your document in the setup chunk.</p>
<p>Remember, you should always check your <code>html</code> document after it knits to make sure that everything has converted as expected, including your figures, bullet points etc.</p>
<p>Let’s load our packages so we can get started.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="making-good-figures.html#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries</span></span>
<span id="cb318-2"><a href="making-good-figures.html#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb318-3"><a href="making-good-figures.html#cb318-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb318-4"><a href="making-good-figures.html#cb318-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb318-5"><a href="making-good-figures.html#cb318-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb318-6"><a href="making-good-figures.html#cb318-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb318-7"><a href="making-good-figures.html#cb318-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-8"><a href="making-good-figures.html#cb318-8" aria-hidden="true" tabindex="-1"></a><span class="co"># turn of sci notation</span></span>
<span id="cb318-9"><a href="making-good-figures.html#cb318-9" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span></code></pre></div>
<div id="best-practices-for-effective-figures" class="section level2" number="17.1">
<h2>
<span class="header-section-number">17.1</span> Best practices for effective figures<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('best-practices-for-effective-figures')" onmouseout="reset_tooltip('best-practices-for-effective-figures-tooltip')"><span class="tooltiptext" id="best-practices-for-effective-figures-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Effective figures are used to tell a story. You can think of your exploratory analysis as the first step in determining what story the data tells (a fact finding mission if you will). Once you have determined what your specific question hypothesis is, the next step is narrowing down what analysis you will perform. Then you will identify your central results and interpret them in the context of your question. Your next step is communicating your results. At this point you need to identify which figures serve to communicate individual, specific points in the overall narrative.</p>
<p>In our example, we have refined our question to “Have impacts due to natural disasters increased at a global scale?” To answer this question, we are calculating the total annual loss of life and annual total economic damages incurred for each disaster type.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="making-good-figures.html#cb319-1" aria-hidden="true" tabindex="-1"></a>disaster <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"data/nat-disasters_emdat-query-2021-10-05.txt"</span>, <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">skip =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb319-2"><a href="making-good-figures.html#cb319-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb319-3"><a href="making-good-figures.html#cb319-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-4"><a href="making-good-figures.html#cb319-4" aria-hidden="true" tabindex="-1"></a>total_yr <span class="ot">&lt;-</span> disaster <span class="sc">%&gt;%</span></span>
<span id="cb319-5"><a href="making-good-figures.html#cb319-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(total_damages_000_us)) <span class="sc">%&gt;%</span></span>
<span id="cb319-6"><a href="making-good-figures.html#cb319-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,disaster_type) <span class="sc">%&gt;%</span></span>
<span id="cb319-7"><a href="making-good-figures.html#cb319-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_damages_yr =</span> <span class="fu">sum</span>(total_damages_000_us))</span>
<span id="cb319-8"><a href="making-good-figures.html#cb319-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-9"><a href="making-good-figures.html#cb319-9" aria-hidden="true" tabindex="-1"></a>deaths <span class="ot">&lt;-</span> disaster <span class="sc">%&gt;%</span></span>
<span id="cb319-10"><a href="making-good-figures.html#cb319-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(total_deaths)) <span class="sc">%&gt;%</span></span>
<span id="cb319-11"><a href="making-good-figures.html#cb319-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, disaster_type) <span class="sc">%&gt;%</span></span>
<span id="cb319-12"><a href="making-good-figures.html#cb319-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_deaths_yr =</span> <span class="fu">sum</span>(total_deaths)) </span></code></pre></div>
<p>Then we create bubble plot showing the total loss of life and total damages incurred for each disaster type in each year.</p>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-261"></span>
<p class="caption marginnote shownote">
Figure 17.1: Impacts due to natural disasters (1900 - 2020). Impacts were calculated as total annual economic costs (top) and total annual loss of life (bottom) due to each disaster type per year. The size of the bubble is scaled to cost [$] and total deaths [100k]. Data was obtained from EMDAT/International Disaster Database
</p>
<img src="_main_files/figure-html/unnamed-chunk-261-1.png" alt="Impacts due to natural disasters (1900 - 2020). Impacts were calculated as total annual economic costs (top) and total annual loss of life (bottom) due to each disaster type per year. The size of the bubble is scaled to cost [$] and total deaths [100k]. Data was obtained from EMDAT/International Disaster Database" width="672">
</div>
<div id="ques:eff-1" class="question">
<p class="question-begin">
► Question 17.1
</p>
<div class="question-body">
<p>Summarize the overall narrative for the “story” we want to communicate based on our central question and state the specific point that each of these figures makes.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:eff-2" class="question">
<p class="question-begin">
► Question 17.2
</p>
<div class="question-body">
<p>Data visualizations should be clear, accessible, transparent, and honest. For each of these categories list at least three criteria/guidelines that detail how data visualizations fulfill this category. Assess whether our figure(s) above fulfill these criteria and list at least three things that could be improved based this set of criteria.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="best-practices-for-communicating-results" class="section level2" number="17.2">
<h2>
<span class="header-section-number">17.2</span> Best practices for communicating results<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('best-practices-for-communicating-results')" onmouseout="reset_tooltip('best-practices-for-communicating-results-tooltip')"><span class="tooltiptext" id="best-practices-for-communicating-results-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Visualizations are a key component to effectively communicating your results. A good rule of thumb is that your written description of your results should allow the reader to understand what you are trying to communicate even without visualizations and that your title &amp; legend should be descriptive enough that even without the written results (some would even say methods) the reader would understand the results as well.</p>
<div id="ques:eff-3" class="question">
<p class="question-begin">
► Question 17.3
</p>
<div class="question-body">
<p>Give a description of what the components of an effective figure title &amp; legend should look like and assess whether the figure legend above fulfills these criteria. List points for improvement.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:eff-4" class="question">
<p class="question-begin">
► Question 17.4
</p>
<div class="question-body">
<p>Give a description of what an effective description of results should look like and write a description for the figure(s) above.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:eff-5" class="question">
<p class="question-begin">
► Question 17.5
</p>
<div class="question-body">
<p>Give a description of the components of an effective discussion and write a brief discussion of the results of our example above.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="practice-the-best-practices" class="section level2" number="17.3">
<h2>
<span class="header-section-number">17.3</span> Practice the best practices!<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('practice-the-best-practices')" onmouseout="reset_tooltip('practice-the-best-practices-tooltip')"><span class="tooltiptext" id="practice-the-best-practices-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<div id="ques:eff-6" class="question">
<p class="question-begin">
► Question 17.6
</p>
<div class="question-body">
<p>Use one of the questions you explored for last week’s assignments and complete the following tasks:</p>
<ul>
<li>State the overall broad question you are asking</li>
<li>Summarize your “methods” in 2-3 sentences: How are you transforming/analyzing the data to specifically answer your question?</li>
<li>Summarize the narrative of the story you want to communicate with this analysis and specify how the visualization serves the overall narrative.</li>
<li>Generate your figure. Use bullet points to assess whether your visualization is clear, accessible, transparent, and honest.</li>
<li>Write an effective title/legend for your figure.</li>
<li>Write an effective description of your results.</li>
<li>Write an effective interpretation discussion/interpretation of your results.</li>
</ul>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="spatial-visualization" class="section level2" number="17.4">
<h2>
<span class="header-section-number">17.4</span> Spatial visualization<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('spatial-visualization')" onmouseout="reset_tooltip('spatial-visualization-tooltip')"><span class="tooltiptext" id="spatial-visualization-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>You have probably noticed that for some of the geographic comparisons were are making the most effective way to communicate those results would be to create a map with countries color coded according to the metric we are assessing.</p>
<p>Let’s learn a straightforward method for visualization of spatial data.</p>
<p>Install these packages as needed:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="making-good-figures.html#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb320-2"><a href="making-good-figures.html#cb320-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearthdata)</span>
<span id="cb320-3"><a href="making-good-figures.html#cb320-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-4"><a href="making-good-figures.html#cb320-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code></pre></div>
<p>The first thing we need is is some maps! The package <code>rnaturalearth</code> provides a map of countries of the entire world. Let’s load a map as an <code>sf</code> class.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="making-good-figures.html#cb321-1" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">"medium"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb321-2"><a href="making-good-figures.html#cb321-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-3"><a href="making-good-figures.html#cb321-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(world)</span></code></pre></div>
<pre><code>## [1] "sf"         "data.frame"</code></pre>
<p>We see that world is both a <code>data.frame</code> and a class <code>sf</code>(simple features) which is a class of R object designed speficically for plotting maps.</p>
<p>Let’s take a look at the column names</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="making-good-figures.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(world)</span></code></pre></div>
<pre><code>##  [1] "scalerank"  "featurecla" "labelrank"  "sovereignt" "sov_a3"     "adm0_dif"   "level"      "type"      
##  [9] "admin"      "adm0_a3"    "geou_dif"   "geounit"    "gu_a3"      "su_dif"     "subunit"    "su_a3"     
## [17] "brk_diff"   "name"       "name_long"  "brk_a3"     "brk_name"   "brk_group"  "abbrev"     "postal"    
## [25] "formal_en"  "formal_fr"  "note_adm0"  "note_brk"   "name_sort"  "name_alt"   "mapcolor7"  "mapcolor8" 
## [33] "mapcolor9"  "mapcolor13" "pop_est"    "gdp_md_est" "pop_year"   "lastcensus" "gdp_year"   "economy"   
## [41] "income_grp" "wikipedia"  "fips_10"    "iso_a2"     "iso_a3"     "iso_n3"     "un_a3"      "wb_a2"     
## [49] "wb_a3"      "woe_id"     "adm0_a3_is" "adm0_a3_us" "adm0_a3_un" "adm0_a3_wb" "continent"  "region_un" 
## [57] "subregion"  "region_wb"  "name_len"   "long_len"   "abbrev_len" "tiny"       "homepart"   "geometry"</code></pre>
<p>You can see that it contains quote a bit of information including some data about each country. The column <code>geometry</code> has the information about the country “shapes” (multipolygons) we want to plot.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="making-good-figures.html#cb325-1" aria-hidden="true" tabindex="-1"></a>world <span class="sc">%&gt;%</span></span>
<span id="cb325-2"><a href="making-good-figures.html#cb325-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(geometry) <span class="sc">%&gt;%</span></span>
<span id="cb325-3"><a href="making-good-figures.html#cb325-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 0 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -70.06611 ymin: -18.01973 xmax: 74.89131 ymax: 60.40581
## CRS:           +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
##                         geometry
## 1 MULTIPOLYGON (((-69.89912 1...
## 2 MULTIPOLYGON (((74.89131 37...
## 3 MULTIPOLYGON (((14.19082 -5...
## 4 MULTIPOLYGON (((-63.00122 1...
## 5 MULTIPOLYGON (((20.06396 42...
## 6 MULTIPOLYGON (((20.61133 60...</code></pre>
<p>We can plot the map using <code>ggplot::geom_sf()</code> and the same syntax we generally use. We do not need to specify x or y coordinates as ggplot recognizes that we have passed a object of the class <code>sf</code> and that it contains a column called <code>geometry</code>.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="making-good-figures.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> world) <span class="sc">+</span></span>
<span id="cb327-2"><a href="making-good-figures.html#cb327-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-266-1.png" width="672"></p>
<p>We can manipulate the <code>geom_sf</code> layer using the same arguments we have used for other plot types. For example, let’s make all the countries orange.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="making-good-figures.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> world) <span class="sc">+</span> </span>
<span id="cb328-2"><a href="making-good-figures.html#cb328-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-267-1.png" width="672"></p>
<p>Or, we could color code them according to the column <code>pop_est</code> in the <code>world</code> data.frame which contains population estimates for each country.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="making-good-figures.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> world) <span class="sc">+</span></span>
<span id="cb329-2"><a href="making-good-figures.html#cb329-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> pop_est)) <span class="sc">+</span></span>
<span id="cb329-3"><a href="making-good-figures.html#cb329-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">trans =</span> <span class="st">"sqrt"</span>) <span class="sc">+</span></span>
<span id="cb329-4"><a href="making-good-figures.html#cb329-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-268-1.png" width="672"></p>
<p>Let’s say we want to create a map that compares the number of droughts that occurred in each country from 2010 - 2020. First we would need to transform our raw data.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="making-good-figures.html#cb330-1" aria-hidden="true" tabindex="-1"></a>droughts <span class="ot">&lt;-</span> disaster <span class="sc">%&gt;%</span></span>
<span id="cb330-2"><a href="making-good-figures.html#cb330-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2010</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb330-3"><a href="making-good-figures.html#cb330-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(iso) <span class="sc">%&gt;%</span></span>
<span id="cb330-4"><a href="making-good-figures.html#cb330-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">droughts_total =</span> <span class="fu">n</span>())</span></code></pre></div>
<p>Now we can use <code>left_join()</code> to join the <code>world</code> and <code>drought</code> data.frames. Note that I used the column <code>iso</code> to calculate the number of droughts, this is equivalent to the column <code>iso_a3</code> in the <code>world</code> database. These are internationally recognized codes that designate every country and most independent areas with either a two or in this case three-letter abbreviations.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="making-good-figures.html#cb331-1" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> world <span class="sc">%&gt;%</span></span>
<span id="cb331-2"><a href="making-good-figures.html#cb331-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(droughts, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"iso_a3"</span> <span class="ot">=</span> <span class="st">"iso"</span>))</span>
<span id="cb331-3"><a href="making-good-figures.html#cb331-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-4"><a href="making-good-figures.html#cb331-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(world)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 64 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -70.06611 ymin: -18.01973 xmax: 74.89131 ymax: 60.40581
## CRS:           +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
##   scalerank      featurecla labelrank     sovereignt sov_a3 adm0_dif level              type       admin adm0_a3
## 1         3 Admin-0 country         5    Netherlands    NL1        1     2           Country       Aruba     ABW
## 2         1 Admin-0 country         3    Afghanistan    AFG        0     2 Sovereign country Afghanistan     AFG
## 3         1 Admin-0 country         3         Angola    AGO        0     2 Sovereign country      Angola     AGO
## 4         1 Admin-0 country         6 United Kingdom    GB1        1     2        Dependency    Anguilla     AIA
## 5         1 Admin-0 country         6        Albania    ALB        0     2 Sovereign country     Albania     ALB
## 6         3 Admin-0 country         6        Finland    FI1        1     2           Country       Aland     ALD
##   geou_dif     geounit gu_a3 su_dif     subunit su_a3 brk_diff        name     name_long brk_a3    brk_name
## 1        0       Aruba   ABW      0       Aruba   ABW        0       Aruba         Aruba    ABW       Aruba
## 2        0 Afghanistan   AFG      0 Afghanistan   AFG        0 Afghanistan   Afghanistan    AFG Afghanistan
## 3        0      Angola   AGO      0      Angola   AGO        0      Angola        Angola    AGO      Angola
## 4        0    Anguilla   AIA      0    Anguilla   AIA        0    Anguilla      Anguilla    AIA    Anguilla
## 5        0     Albania   ALB      0     Albania   ALB        0     Albania       Albania    ALB     Albania
## 6        0       Aland   ALD      0       Aland   ALD        0       Aland Aland Islands    ALD       Aland
##   brk_group abbrev postal                    formal_en formal_fr note_adm0 note_brk   name_sort name_alt
## 1      &lt;NA&gt;  Aruba     AW                        Aruba      &lt;NA&gt;     Neth.     &lt;NA&gt;       Aruba     &lt;NA&gt;
## 2      &lt;NA&gt;   Afg.     AF Islamic State of Afghanistan      &lt;NA&gt;      &lt;NA&gt;     &lt;NA&gt; Afghanistan     &lt;NA&gt;
## 3      &lt;NA&gt;   Ang.     AO  People's Republic of Angola      &lt;NA&gt;      &lt;NA&gt;     &lt;NA&gt;      Angola     &lt;NA&gt;
## 4      &lt;NA&gt;   Ang.     AI                         &lt;NA&gt;      &lt;NA&gt;      U.K.     &lt;NA&gt;    Anguilla     &lt;NA&gt;
## 5      &lt;NA&gt;   Alb.     AL          Republic of Albania      &lt;NA&gt;      &lt;NA&gt;     &lt;NA&gt;     Albania     &lt;NA&gt;
## 6      &lt;NA&gt;  Aland     AI                Åland Islands      &lt;NA&gt;      Fin.     &lt;NA&gt;       Aland     &lt;NA&gt;
##   mapcolor7 mapcolor8 mapcolor9 mapcolor13  pop_est gdp_md_est pop_year lastcensus gdp_year
## 1         4         2         2          9   103065     2258.0       NA       2010       NA
## 2         5         6         8          7 28400000    22270.0       NA       1979       NA
## 3         3         2         6          1 12799293   110300.0       NA       1970       NA
## 4         6         6         6          3    14436      108.9       NA         NA       NA
## 5         1         4         1          6  3639453    21810.0       NA       2001       NA
## 6         4         1         4          6    27153     1563.0       NA         NA       NA
##                      economy              income_grp wikipedia fips_10 iso_a2 iso_a3 iso_n3 un_a3 wb_a2 wb_a3
## 1       6. Developing region 2. High income: nonOECD        NA    &lt;NA&gt;     AW    ABW    533   533    AW   ABW
## 2  7. Least developed region           5. Low income        NA    &lt;NA&gt;     AF    AFG    004   004    AF   AFG
## 3  7. Least developed region  3. Upper middle income        NA    &lt;NA&gt;     AO    AGO    024   024    AO   AGO
## 4       6. Developing region  3. Upper middle income        NA    &lt;NA&gt;     AI    AIA    660   660  &lt;NA&gt;  &lt;NA&gt;
## 5       6. Developing region  4. Lower middle income        NA    &lt;NA&gt;     AL    ALB    008   008    AL   ALB
## 6 2. Developed region: nonG7    1. High income: OECD        NA    &lt;NA&gt;     AX    ALA    248   248  &lt;NA&gt;  &lt;NA&gt;
##   woe_id adm0_a3_is adm0_a3_us adm0_a3_un adm0_a3_wb     continent region_un       subregion
## 1     NA        ABW        ABW         NA         NA North America  Americas       Caribbean
## 2     NA        AFG        AFG         NA         NA          Asia      Asia   Southern Asia
## 3     NA        AGO        AGO         NA         NA        Africa    Africa   Middle Africa
## 4     NA        AIA        AIA         NA         NA North America  Americas       Caribbean
## 5     NA        ALB        ALB         NA         NA        Europe    Europe Southern Europe
## 6     NA        ALA        ALD         NA         NA        Europe    Europe Northern Europe
##                   region_wb name_len long_len abbrev_len tiny homepart droughts_total
## 1 Latin America &amp; Caribbean        5        5          5    4       NA             NA
## 2                South Asia       11       11          4   NA        1             65
## 3        Sub-Saharan Africa        6        6          4   NA        1             26
## 4 Latin America &amp; Caribbean        8        8          4   NA       NA              1
## 5     Europe &amp; Central Asia        7        7          4   NA        1             12
## 6     Europe &amp; Central Asia        5       13          5    5       NA             NA
##                         geometry
## 1 MULTIPOLYGON (((-69.89912 1...
## 2 MULTIPOLYGON (((74.89131 37...
## 3 MULTIPOLYGON (((14.19082 -5...
## 4 MULTIPOLYGON (((-63.00122 1...
## 5 MULTIPOLYGON (((20.06396 42...
## 6 MULTIPOLYGON (((20.61133 60...</code></pre>
<p>Now our <code>world</code> data.frame has a column specifying the number of droughts that occurred.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="making-good-figures.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> world) <span class="sc">+</span></span>
<span id="cb333-2"><a href="making-good-figures.html#cb333-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> droughts_total)) <span class="sc">+</span></span>
<span id="cb333-3"><a href="making-good-figures.html#cb333-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">trans =</span> <span class="st">"sqrt"</span>) <span class="sc">+</span></span>
<span id="cb333-4"><a href="making-good-figures.html#cb333-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb333-5"><a href="making-good-figures.html#cb333-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"longitude"</span>, <span class="at">y =</span> <span class="st">"latitude"</span>) <span class="sc">+</span></span>
<span id="cb333-6"><a href="making-good-figures.html#cb333-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb333-7"><a href="making-good-figures.html#cb333-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-271-1.png" width="672"></p>

</div>
</div></body></html>

<p style="text-align: center;">
<a href="exploratory-analysis.html"><button class="btn btn-default">Previous</button></a>
<a href="phenology.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2021-11-15
 using 
R version 4.0.2 (2020-06-22)
</p>
</div>
</div>



</body>
</html>

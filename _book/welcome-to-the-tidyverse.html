<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="7 Welcome to the tidyverse | Data Science for the Natural Environment (FA21)" />
<meta property="og:type" content="book" />





<meta name="author" content="Shannon J. O’Leary" />

<meta name="date" content="2021-09-30" />


<meta name="description" content="7 Welcome to the tidyverse | Data Science for the Natural Environment (FA21)">

<title>7 Welcome to the tidyverse | Data Science for the Natural Environment (FA21)</title>

<link href="libs/tufte-css/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css/msmb.css" rel="stylesheet" />
<script src="libs/accessible-code-block/empty-anchor.js"></script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/plotly-binding/plotly.js"></script>
<script src="libs/typedarray/typedarray.min.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main/plotly-latest.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>



<link rel="stylesheet" href="msmb.css" type="text/css" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script>
function copy_link(id) {
  var dummy = document.createElement('input'),
  text = window.location.href.split(/[?#]/)[0] + '#' + id;
  document.body.appendChild(dummy);
  dummy.value = text;
  dummy.select();
  document.execCommand('copy');
  document.body.removeChild(dummy);
  
  var tooltip = document.getElementById(id + '-tooltip');
  tooltip.innerHTML = 'Copied!';
}

function reset_tooltip(id) {
  var tooltip = document.getElementById(id);
  tooltip.innerHTML = 'Copy link';
}
</script>

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Data Science for the Natural Environment (FA21)<p><p class="author">Shannon J. O'Leary</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Overview</a>
<a href="what-even-is-data-science.html"><span class="toc-section-number">1</span> What even is data science?</a>
<a href="installing-rrstudio.html"><span class="toc-section-number">2</span> Installing R/Rstudio</a>
<a href="project-management-and-rmarkdown-basics.html"><span class="toc-section-number">3</span> Project management and Rmarkdown Basics</a>
<a href="r-functions-objects-vectors---oh-my.html"><span class="toc-section-number">4</span> R: Functions, Objects, Vectors - oh my!</a>
<a href="identifying-essential-fish-habitat-shark-nurseries-on-the-texas-coast.html"><span class="toc-section-number">5</span> Identifying essential fish habitat: Shark Nurseries on the Texas coast</a>
<a href="intro-to-data-frames.html"><span class="toc-section-number">6</span> Intro to data frames</a>
<a id="active-page" href="welcome-to-the-tidyverse.html"><span class="toc-section-number">7</span> Welcome to the tidyverse</a><ul class="toc-sections">
<li class="toc"><a href="#data-wrangling"> Data Wrangling</a></li>
<li class="toc"><a href="#selecting-and-organizing-columns"> Selecting and organizing columns</a></li>
<li class="toc"><a href="#separate-uniting-columns"> Separate &amp; uniting columns</a></li>
<li class="toc"><a href="#filtering-subsetting-rows"> Filtering (subsetting) rows</a></li>
<li class="toc"><a href="#adding-new-variables"> Adding new variables</a></li>
<li class="toc"><a href="#NA"> Create new <code>data.frame</code> based on another</a></li>
<li class="toc"><a href="#combining-verbs"> Combining verbs</a></li>
<li class="toc"><a href="#producing-tidy-data-sets"> Producing tidy data sets</a></li>
</ul>
<a href="catch-data-analysis.html"><span class="toc-section-number">8</span> Catch data analysis</a>
<a href="scientific-misconduct-and-the-reproducible-crisis.html"><span class="toc-section-number">9</span> Scientific misconduct and the reproducible crisis</a>
<a href="responsible-research-is-reproducible-research.html"><span class="toc-section-number">10</span> Responsible Research is Reproducible Research</a>
<a href="project-management-revisited.html"><span class="toc-section-number">11</span> Project Management Revisited</a>
<a href="data-wrangling-tidy-data-revisited.html"><span class="toc-section-number">12</span> Data Wrangling &amp; Tidy data Revisited</a>
<a href="climate-change.html"><span class="toc-section-number">13</span> Climate Change</a>
<a href="visualization.html"><span class="toc-section-number">14</span> Visualization</a>
<a href="visualizations-as-a-tool-for-misinformation.html"><span class="toc-section-number">15</span> Visualizations as a tool for misinformation</a>
<a href="references.html">References</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div id="welcome-to-the-tidyverse" class="section level1">
<h1>
<span class="header-section-number">7</span> Welcome to the tidyverse</h1>
<p><strong>Learning Objectives</strong></p>
<p>After completing this tutorial you should</p>
<ul>
<li>be able to read a tab-delimited file into R.</li>
<li>use <code>filter()</code> and <code>select()</code> to include/exclude rows and columns from a data frame.</li>
<li>use <code>distinct()</code> to select only unique/distinct rows from a data frame.</li>
<li>use <code>separate()</code> and <code>unite()</code> to separate content from a column across multiple columns and vice versa.</li>
<li>use <code>mutate()</code> to add new columns.</li>
<li>use <code>group_by()</code> to group rows.</li>
<li>use <code>summarize()</code> to calculate summary statistics.</li>
</ul>
<p>You should have a <code>DataWrangling.Rmd</code> in your project directory. Use that file to work through this tutorial - you will hand in your rendered (“knitted”) rmarkdown file as your homework assignment. So, first thing in the <code>YAML</code> header, change the author to your name. You will use this <code>Rmarkdown</code> file to record your answers. Remember to use comments to describe your code; at minimum you should have one comment per code set<label for="tufte-sn-28" class="margin-toggle sidenote-number">28</label><input type="checkbox" id="tufte-sn-28" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">28</span> You should do this even if you are adding code yourself or if you are using code from our manual, even if it isn’t commented in the manual … you may of course add as many comments as you need to be able to recall what you did</span>.</p>
<p>As always, let’s start by loading our packages needed for this analysis.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="welcome-to-the-tidyverse.html#cb111-1"></a><span class="co"># load libraries (make sure you have installed them first)</span></span>
<span id="cb111-2"><a href="welcome-to-the-tidyverse.html#cb111-2"></a><span class="kw">library</span>(knitr)</span>
<span id="cb111-3"><a href="welcome-to-the-tidyverse.html#cb111-3"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<div id="data-wrangling" class="section level2">
<h2>
<span class="header-section-number">7.1</span> Data Wrangling<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('data-wrangling')" onmouseout="reset_tooltip('data-wrangling-tooltip')"><span class="tooltiptext" id="data-wrangling-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Now that we have a data frame to play with, let’s explore some data wrangling options using <code>dplyr</code>. The <code>d</code> stands for <code>data</code> and the <code>plyr</code> stands for <code>plyers</code> - this package is designed to manipulate data frames<label for="tufte-sn-29" class="margin-toggle sidenote-number">29</label><input type="checkbox" id="tufte-sn-29" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">29</span> This is also known as <code>data wrangling</code>, manipulating is not a negative thing in this case it means you can clean up and format the data in appropriate way to fit the questions you are asking and allow to to display the information in a helpful way; you will also see this described as data transformation.</span>. We are going to focus on the central actions (<code>verbs</code>) that will allow you to manipulate the data frame.</p>
<p>We will compare using excel vs R (or another coding language) down the line but here are some of the main advantages to using code -</p>
<ul>
<li>You aren’t manipulating the raw data set - if you make a mistake or accidentally overwrite something you haven’t made any permanent damage.</li>
<li>You can manipulate data sets too large to easily handle in Excel.</li>
<li>If you update your data set or have a second identically formatted data set you just have to re-run the code.</li>
</ul>
<p>Be sure to record all the steps (code chunks) in your Rmarkdown - both the examples given here and the applications you will be asked to make. You can copy and paste, but you will find that writing out the code will help you get more used to syntax, how autocomplete etc. works. Make use of the fact that you can add headers, text etc. + code chunks. Be sure to comment your code.</p>
<p>These are central concepts that you will use and reuse throughout the semester so you will likely want to refer back to this document. A good way to create a “cheatsheet” would be to for example for each function write a short description of what it does in general (refer to this manual) before each code chunk, then make your comment in the code specific to your example. Similarly use normal text to refer to the question numbers in this manual as you work through the problem sets.</p>
</div>
<div id="selecting-and-organizing-columns" class="section level2">
<h2>
<span class="header-section-number">7.2</span> Selecting and organizing columns<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('selecting-and-organizing-columns')" onmouseout="reset_tooltip('selecting-and-organizing-columns-tooltip')"><span class="tooltiptext" id="selecting-and-organizing-columns-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Let’s start by loading our data set.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="welcome-to-the-tidyverse.html#cb112-1"></a><span class="co"># read catch data</span></span>
<span id="cb112-2"><a href="welcome-to-the-tidyverse.html#cb112-2"></a>catch &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">"data/longline_catchdata.txt"</span>, <span class="dt">delim =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span></code></pre></div>
<p><label for="tufte-mn-2" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-2" class="margin-toggle"><span class="marginnote"><span style="display: block;">We will make heavy use of the magrittr pipe <code>%&gt;%</code> this allows you to link commands together; think of it as “and now do this”.</span>
<span style="display: block;">Because we are mostly interested in what the individual functions (verbs) do we will not always assign a new object, but just having it print to the console/below the code chunk we will be able to immediately assess the affect. By piping our function to <code>head()</code> it will print just the first 6 lines.</span></span></p>
<p>The function <code>select()</code> is used to select a subset of columns from a data set.</p>
<p>For example, you can select just the Site and Species columns.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="welcome-to-the-tidyverse.html#cb113-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb113-2"><a href="welcome-to-the-tidyverse.html#cb113-2"></a><span class="st">  </span><span class="kw">select</span>(Site, Species) <span class="op">%&gt;%</span></span>
<span id="cb113-3"><a href="welcome-to-the-tidyverse.html#cb113-3"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   Site        Species      
##   &lt;chr&gt;       &lt;chr&gt;        
## 1 Aransas_Bay Bagre_marinus
## 2 Aransas_Bay Bagre_marinus
## 3 Aransas_Bay Bagre_marinus
## 4 Aransas_Bay Bagre_marinus
## 5 Aransas_Bay Bagre_marinus
## 6 Aransas_Bay Bagre_marinus</code></pre>
<div id="ques:tidy-1" class="question">
<p class="question-begin">
► Question 7.1
</p>
<div class="question-body">
<p>
How would you select just Day, Month, and Year columns?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>You PCL column doesn’t contain any information (all <code>NA</code>s) - you can also eliminate individual columns by name.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="welcome-to-the-tidyverse.html#cb115-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb115-2"><a href="welcome-to-the-tidyverse.html#cb115-2"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>PCL)</span></code></pre></div>
<pre><code>## # A tibble: 2,325 x 11
##    Site        Species       Sex   Observed_Stage    FL   STL Hook_Size   Set   Day Month  Year
##    &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Aransas_Bay Bagre_marinus U     &lt;NA&gt;             287   353        10     1    28     7  2015
##  2 Aransas_Bay Bagre_marinus U     &lt;NA&gt;             425   495        10     1    28     7  2015
##  3 Aransas_Bay Bagre_marinus U     &lt;NA&gt;             416   502        15     1    28     7  2015
##  4 Aransas_Bay Bagre_marinus U     &lt;NA&gt;             416   507        10     1    28     7  2015
##  5 Aransas_Bay Bagre_marinus U     &lt;NA&gt;             418   510        15     1    28     7  2015
##  6 Aransas_Bay Bagre_marinus U     &lt;NA&gt;             434   515        10     1    28     7  2015
##  7 Aransas_Bay Bagre_marinus U     &lt;NA&gt;             427   520        15     1    28     7  2015
##  8 Aransas_Bay Bagre_marinus U     &lt;NA&gt;             446   532        10     1    28     7  2015
##  9 Aransas_Bay Bagre_marinus U     &lt;NA&gt;             465   538        10     1    28     7  2015
## 10 Aransas_Bay Bagre_marinus U     &lt;NA&gt;             450   539        10     1    28     7  2015
## # ... with 2,315 more rows</code></pre>
<div id="ques:tidy-2" class="question">
<p class="question-begin">
► Question 7.2
</p>
<div class="question-body">
<p>
How would you eliminate hook size from the data set?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>You can also eliminate multiple columns by name, for example you would remove Day, Month and Year like this:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="welcome-to-the-tidyverse.html#cb117-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb117-2"><a href="welcome-to-the-tidyverse.html#cb117-2"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Day, <span class="op">-</span>Month, <span class="op">-</span>Year)</span></code></pre></div>
<pre><code>## # A tibble: 2,325 x 9
##    Site        Species       Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set
##    &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   287   353        10     1
##  2 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   425   495        10     1
##  3 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   502        15     1
##  4 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   507        10     1
##  5 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   418   510        15     1
##  6 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   434   515        10     1
##  7 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   427   520        15     1
##  8 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   446   532        10     1
##  9 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   465   538        10     1
## 10 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   450   539        10     1
## # ... with 2,315 more rows</code></pre>
<p>If you want to re-arrange columns in your data frame, you would also use <code>select()</code>.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="welcome-to-the-tidyverse.html#cb119-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb119-2"><a href="welcome-to-the-tidyverse.html#cb119-2"></a><span class="st">  </span><span class="kw">select</span>(FL, Sex, Day)</span></code></pre></div>
<pre><code>## # A tibble: 2,325 x 3
##       FL Sex     Day
##    &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
##  1   287 U        28
##  2   425 U        28
##  3   416 U        28
##  4   416 U        28
##  5   418 U        28
##  6   434 U        28
##  7   427 U        28
##  8   446 U        28
##  9   465 U        28
## 10   450 U        28
## # ... with 2,315 more rows</code></pre>
<p>If you wanted to move a set of columns to the front, but not have to type in all the other column names you can use <code>everything()</code>.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="welcome-to-the-tidyverse.html#cb121-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb121-2"><a href="welcome-to-the-tidyverse.html#cb121-2"></a><span class="st">  </span><span class="kw">select</span>(Day, Month, Year, <span class="kw">everything</span>())</span></code></pre></div>
<pre><code>## # A tibble: 2,325 x 12
##      Day Month  Year Site        Species       Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1    28     7  2015 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   287   353        10     1
##  2    28     7  2015 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   425   495        10     1
##  3    28     7  2015 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   502        15     1
##  4    28     7  2015 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   507        10     1
##  5    28     7  2015 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   418   510        15     1
##  6    28     7  2015 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   434   515        10     1
##  7    28     7  2015 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   427   520        15     1
##  8    28     7  2015 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   446   532        10     1
##  9    28     7  2015 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   465   538        10     1
## 10    28     7  2015 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   450   539        10     1
## # ... with 2,315 more rows</code></pre>
<p>There you go. Simple as that.</p>
</div>
<div id="separate-uniting-columns" class="section level2">
<h2>
<span class="header-section-number">7.3</span> Separate &amp; uniting columns<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('separate-uniting-columns')" onmouseout="reset_tooltip('separate-uniting-columns-tooltip')"><span class="tooltiptext" id="separate-uniting-columns-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Occasionally you will find that you want to combine the contents of two columns into a single column (e.g. first name, last name) or at other times you may want to separate the contents of a column over multiple columns (e.g. dates).</p>
<p>For example, you may have noticed that the Species is entered as <code>genus_species</code> - what if you wanted to have two separate columns with that information? The function <code>separate()</code> is a function that will split the contents from one column across two or more columns.</p>
<p>To do this you need to specify the new column names (<code>into = c("column1", "column2")</code>), and what pattern should be used to determine where the content should be split (<code>sep = "pattern"</code>).</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="welcome-to-the-tidyverse.html#cb123-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb123-2"><a href="welcome-to-the-tidyverse.html#cb123-2"></a><span class="st">  </span><span class="kw">separate</span>(Species, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">"species"</span>, <span class="st">"genus"</span>), <span class="dt">sep =</span> <span class="st">"_"</span>, <span class="dt">remove =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2,325 x 14
##    Site        Species  species genus Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year
##    &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Aransas_Bay Bagre_m~ Bagre   mari~ U     &lt;NA&gt;              NA   287   353        10     1    28     7  2015
##  2 Aransas_Bay Bagre_m~ Bagre   mari~ U     &lt;NA&gt;              NA   425   495        10     1    28     7  2015
##  3 Aransas_Bay Bagre_m~ Bagre   mari~ U     &lt;NA&gt;              NA   416   502        15     1    28     7  2015
##  4 Aransas_Bay Bagre_m~ Bagre   mari~ U     &lt;NA&gt;              NA   416   507        10     1    28     7  2015
##  5 Aransas_Bay Bagre_m~ Bagre   mari~ U     &lt;NA&gt;              NA   418   510        15     1    28     7  2015
##  6 Aransas_Bay Bagre_m~ Bagre   mari~ U     &lt;NA&gt;              NA   434   515        10     1    28     7  2015
##  7 Aransas_Bay Bagre_m~ Bagre   mari~ U     &lt;NA&gt;              NA   427   520        15     1    28     7  2015
##  8 Aransas_Bay Bagre_m~ Bagre   mari~ U     &lt;NA&gt;              NA   446   532        10     1    28     7  2015
##  9 Aransas_Bay Bagre_m~ Bagre   mari~ U     &lt;NA&gt;              NA   465   538        10     1    28     7  2015
## 10 Aransas_Bay Bagre_m~ Bagre   mari~ U     &lt;NA&gt;              NA   450   539        10     1    28     7  2015
## # ... with 2,315 more rows</code></pre>
<div id="ques:tidy-3" class="question">
<p class="question-begin">
► Question 7.3
</p>
<div class="question-body">
<p>In some cases, there might not be a distinct pattern that you can use to identify where to split the column content. In this case it may be more helpful to use the position (e.g. “split at”third character from the left") Look up the <code>separate()</code> function in the help and determine how you could split the Year column so you get two new columns by splitting off the last two digits (i.e. 2021 would be 20 and 21). Then eliminate the column containing the first two digits.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>To do the opposite action you would use <code>unite()</code>. For example, if we wanted to create a column called date that had the day, month, and year of each sampling trip separated by an <code>_</code>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="welcome-to-the-tidyverse.html#cb125-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb125-2"><a href="welcome-to-the-tidyverse.html#cb125-2"></a><span class="st">  </span><span class="kw">unite</span>(Date, Day, Month, Year, <span class="dt">sep =</span> <span class="st">"_"</span>, <span class="dt">remove =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2,325 x 13
##    Site        Species       Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set Date       Day Month  Year
##    &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   287   353        10     1 28_7_20~    28     7  2015
##  2 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   425   495        10     1 28_7_20~    28     7  2015
##  3 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   502        15     1 28_7_20~    28     7  2015
##  4 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   507        10     1 28_7_20~    28     7  2015
##  5 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   418   510        15     1 28_7_20~    28     7  2015
##  6 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   434   515        10     1 28_7_20~    28     7  2015
##  7 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   427   520        15     1 28_7_20~    28     7  2015
##  8 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   446   532        10     1 28_7_20~    28     7  2015
##  9 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   465   538        10     1 28_7_20~    28     7  2015
## 10 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   450   539        10     1 28_7_20~    28     7  2015
## # ... with 2,315 more rows</code></pre>
<div id="ques:tidy-4" class="question">
<p class="question-begin">
► Question 7.4
</p>
<div class="question-body">
<p>Create a data set with the following columns in this sequence</p>
<ul>
<li>Set_ID (combining day, month, year, and set)</li>
<li>Genus</li>
<li>Species</li>
<li>FL</li>
<li>STL</li>
</ul>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="filtering-subsetting-rows" class="section level2">
<h2>
<span class="header-section-number">7.4</span> Filtering (subsetting) rows<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('filtering-subsetting-rows')" onmouseout="reset_tooltip('filtering-subsetting-rows-tooltip')"><span class="tooltiptext" id="filtering-subsetting-rows-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Until you want to visualize a table how the rows are arranged is not really important. However, when generating reports for example you might want values to be listed in a specific way. This can be done using the function <code>arrange()</code>.</p>
<p>For example, if we wanted to arrange our dataframe based on the <code>Observed_Stage</code> column we could do the following:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="welcome-to-the-tidyverse.html#cb127-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb127-2"><a href="welcome-to-the-tidyverse.html#cb127-2"></a><span class="st">  </span><span class="kw">arrange</span>(Observed_Stage)</span></code></pre></div>
<pre><code>## # A tibble: 2,325 x 12
##    Site               Species         Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year
##    &lt;chr&gt;              &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Redfish_Bay        Sphyrna_tiburo  M     MAT              622   668   850        10     1     8     9  2015
##  2 Redfish_Bay        Sphyrna_tiburo  M     MAT              656   710   869        10     1     8     9  2015
##  3 Redfish_Bay        Sphyrna_tiburo  F     MAT              708   770   979        15     2     8     9  2015
##  4 Corpus_Christi_Bay Sphyrna_tiburo  M     MAT              695   757   954        10     2    12     9  2016
##  5 Corpus_Christi_Bay Sphyrna_tiburo  F     MAT              760   861  1090        10     2    12     9  2016
##  6 Corpus_Christi_Bay Sphyrna_tiburo  M     MAT              621   689   856        10     2    27     9  2016
##  7 Redfish_Bay        Sphyrna_tiburo  F     MAT              781   853  1020        10     4    29     9  2016
##  8 Redfish_Bay        Sphyrna_tiburo  M     MAT              721   783   980        10     3    11     8  2017
##  9 Redfish_Bay        Carcharhinus_b~ U     UND               NA    NA    NA        15     2    16     6  2016
## 10 Corpus_Christi_Bay Sphyrna_tiburo  U     UND               NA    NA    NA        10     1    27     9  2016
## # ... with 2,315 more rows</code></pre>
<div id="ques:tidy-8" class="question">
<p class="question-begin">
► Question 7.5
</p>
<div class="question-body">
<p>
How would sort your table by Sex?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Characters are sorted alphabetically, numeric columns from smallest to largest value. If you want to order your values from largest to smallest, you can specify that using <code>desc()</code></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="welcome-to-the-tidyverse.html#cb129-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb129-2"><a href="welcome-to-the-tidyverse.html#cb129-2"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(FL))</span></code></pre></div>
<pre><code>## # A tibble: 2,325 x 12
##    Site               Species         Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year
##    &lt;chr&gt;              &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Aransas_Bay        Carcharhinus_l~ F     &lt;NA&gt;            1042  1140  1410        15     1    25     5  2016
##  2 Redfish_Bay        Carcharhinus_b~ F     &lt;NA&gt;             812   900  1090        15     1    16     6  2016
##  3 Redfish_Bay        Carcharhinus_b~ M     &lt;NA&gt;             792   882  1092        15     2    16     6  2016
##  4 Corpus_Christi_Bay Sphyrna_tiburo  F     MAT              760   861  1090        10     2    12     9  2016
##  5 Redfish_Bay        Sphyrna_tiburo  F     MAT              781   853  1020        10     4    29     9  2016
##  6 Corpus_Christi_Bay Sciaenops_ocel~ U     &lt;NA&gt;              NA   841   950        10     3    25     9  2018
##  7 Redfish_Bay        Carcharhinus_l~ M     &lt;NA&gt;             740   840  1010        15     3    29     9  2016
##  8 Redfish_Bay        Carcharhinus_b~ M     &lt;NA&gt;             740   820  1020        10     4     1     8  2016
##  9 Aransas_Bay        Carcharhinus_l~ M     &lt;NA&gt;             720   812   912        15     4    22     9  2016
## 10 Redfish_Bay        Sphyrna_tiburo  M     MAT              721   783   980        10     3    11     8  2017
## # ... with 2,315 more rows</code></pre>
<p>The function <code>filter()</code> is used to subset a data frame by row.</p>
<p>We do this using <code>regular expressions</code> and the <code>boolean operators</code> we previously encounter to describe the content of sets of rows.</p>
<p>For example, we might a <code>data.frame</code> with only Gafftop sail catfish (<em>Bagre marinus</em>).</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="welcome-to-the-tidyverse.html#cb131-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb131-2"><a href="welcome-to-the-tidyverse.html#cb131-2"></a><span class="st">  </span><span class="kw">filter</span>(Species <span class="op">==</span><span class="st"> "Bagre_marinus"</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,511 x 12
##    Site        Species       Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year
##    &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   287   353        10     1    28     7  2015
##  2 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   425   495        10     1    28     7  2015
##  3 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   502        15     1    28     7  2015
##  4 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   507        10     1    28     7  2015
##  5 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   418   510        15     1    28     7  2015
##  6 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   434   515        10     1    28     7  2015
##  7 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   427   520        15     1    28     7  2015
##  8 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   446   532        10     1    28     7  2015
##  9 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   465   538        10     1    28     7  2015
## 10 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   450   539        10     1    28     7  2015
## # ... with 1,501 more rows</code></pre>
<div id="ques:tidy-9" class="question">
<p class="question-begin">
► Question 7.6
</p>
<div class="question-body">
<p>
How would you select only rows containing Scalloped Hammerheads (<em>Sphyrna lewini</em>)?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><label for="tufte-sn-30" class="margin-toggle sidenote-number">30</label><input type="checkbox" id="tufte-sn-30" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">30</span> Note: you need to use <code>==</code> (not <code>=</code> if you are looking for an exact match).</span></p>
<p>If want all rows but Gafftop sailfish you can use a <code>!</code> to say “not that”.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="welcome-to-the-tidyverse.html#cb133-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb133-2"><a href="welcome-to-the-tidyverse.html#cb133-2"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>Species <span class="op">==</span><span class="st"> "Bagre_marinus"</span>)</span></code></pre></div>
<pre><code>## # A tibble: 814 x 12
##    Site               Species         Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year
##    &lt;chr&gt;              &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Redfish_Bay        Rhizoprionodon~ M     &lt;NA&gt;             351   378   433        15     1    29     7  2015
##  2 Redfish_Bay        Sphyrna_tiburo  F     &lt;NA&gt;             470   430   600        10     3    29     7  2015
##  3 Redfish_Bay        Hypanus_americ~ F     &lt;NA&gt;              NA    NA   670        15     3    29     7  2015
##  4 Redfish_Bay        Hypanus_sabina  F     &lt;NA&gt;              NA    NA   340        10     3    29     7  2015
##  5 Redfish_Bay        Hypanus_americ~ M     &lt;NA&gt;              NA    NA   810        10     4    29     7  2015
##  6 Corpus_Christi_Bay Carcharhinus_l~ F     &lt;NA&gt;             609   670   820        15     1    30     7  2015
##  7 Corpus_Christi_Bay Sphyrna_tiburo  M     &lt;NA&gt;             495   485   615        10     2    24     8  2015
##  8 Corpus_Christi_Bay Sphyrna_tiburo  F     &lt;NA&gt;             550   370   720        10     2    24     8  2015
##  9 Corpus_Christi_Bay Sphyrna_tiburo  M     &lt;NA&gt;             470   505   645        10     3    24     8  2015
## 10 Corpus_Christi_Bay Sphyrna_tiburo  F     &lt;NA&gt;             540   565   720        10     3    24     8  2015
## # ... with 804 more rows</code></pre>
<div id="ques:tidy-10" class="question">
<p class="question-begin">
► Question 7.7
</p>
<div class="question-body">
<p>
How would you create a dataframe without Scalloped Hammerheads (<em>Sphyrna lewini</em>) entries?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Sometimes you might want to select rows that match one of a set of values<label for="tufte-sn-31" class="margin-toggle sidenote-number">31</label><input type="checkbox" id="tufte-sn-31" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">31</span> Recall, the function <code>c()</code> (concatenate) creates a vector</span>.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="welcome-to-the-tidyverse.html#cb135-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb135-2"><a href="welcome-to-the-tidyverse.html#cb135-2"></a><span class="st">  </span><span class="kw">filter</span>(Species <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Sciades_felis"</span>, <span class="st">"Bagre_marinus"</span>, <span class="st">"Synodus_foetens"</span>))</span></code></pre></div>
<pre><code>## # A tibble: 2,166 x 12
##    Site        Species       Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year
##    &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   287   353        10     1    28     7  2015
##  2 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   425   495        10     1    28     7  2015
##  3 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   502        15     1    28     7  2015
##  4 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   507        10     1    28     7  2015
##  5 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   418   510        15     1    28     7  2015
##  6 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   434   515        10     1    28     7  2015
##  7 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   427   520        15     1    28     7  2015
##  8 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   446   532        10     1    28     7  2015
##  9 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   465   538        10     1    28     7  2015
## 10 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   450   539        10     1    28     7  2015
## # ... with 2,156 more rows</code></pre>
<p>Again, if you wanted everything but rows containing those values you would preface it with a <code>!</code>.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="welcome-to-the-tidyverse.html#cb137-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb137-2"><a href="welcome-to-the-tidyverse.html#cb137-2"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>Species <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Sciades_felis"</span>, <span class="st">"Bagre_marinus"</span>, <span class="st">"Synodus_foetens"</span>))</span></code></pre></div>
<pre><code>## # A tibble: 159 x 12
##    Site               Species         Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year
##    &lt;chr&gt;              &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Redfish_Bay        Rhizoprionodon~ M     &lt;NA&gt;             351   378   433        15     1    29     7  2015
##  2 Redfish_Bay        Sphyrna_tiburo  F     &lt;NA&gt;             470   430   600        10     3    29     7  2015
##  3 Redfish_Bay        Hypanus_americ~ F     &lt;NA&gt;              NA    NA   670        15     3    29     7  2015
##  4 Redfish_Bay        Hypanus_sabina  F     &lt;NA&gt;              NA    NA   340        10     3    29     7  2015
##  5 Redfish_Bay        Hypanus_americ~ M     &lt;NA&gt;              NA    NA   810        10     4    29     7  2015
##  6 Corpus_Christi_Bay Carcharhinus_l~ F     &lt;NA&gt;             609   670   820        15     1    30     7  2015
##  7 Corpus_Christi_Bay Sphyrna_tiburo  M     &lt;NA&gt;             495   485   615        10     2    24     8  2015
##  8 Corpus_Christi_Bay Sphyrna_tiburo  F     &lt;NA&gt;             550   370   720        10     2    24     8  2015
##  9 Corpus_Christi_Bay Sphyrna_tiburo  M     &lt;NA&gt;             470   505   645        10     3    24     8  2015
## 10 Corpus_Christi_Bay Sphyrna_tiburo  F     &lt;NA&gt;             540   565   720        10     3    24     8  2015
## # ... with 149 more rows</code></pre>
<div id="ques:tidy-11" class="question">
<p class="question-begin">
► Question 7.8
</p>
<div class="question-body">
<p>
How would you subset a data frame to contain only entries for different species in the genus Carcharhinus aka the sharky-sharks? There are four species in the data set - Carcharhinus_leucas, Carcharhinus_brevipinna, Carcharhinus_limbatus, Carcharhinus_porosus.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>For numbers you likely aren’t just searching for exact matches, you also want to be able to set threshold values and select everything above or below. For example, you can select all rows with values greater than a certain value using <code>&gt;</code>.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="welcome-to-the-tidyverse.html#cb139-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb139-2"><a href="welcome-to-the-tidyverse.html#cb139-2"></a><span class="st">  </span><span class="kw">filter</span>(FL <span class="op">&gt;</span><span class="st"> </span><span class="dv">440</span>)</span></code></pre></div>
<pre><code>## # A tibble: 907 x 12
##    Site        Species       Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year
##    &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   446   532        10     1    28     7  2015
##  2 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   465   538        10     1    28     7  2015
##  3 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   450   539        10     1    28     7  2015
##  4 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   496   565        10     1    28     7  2015
##  5 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   476   569        10     1    28     7  2015
##  6 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   495   570        10     1    28     7  2015
##  7 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   490   575        10     1    28     7  2015
##  8 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   486   581        10     1    28     7  2015
##  9 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   503   589        10     1    28     7  2015
## 10 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   489   590        10     1    28     7  2015
## # ... with 897 more rows</code></pre>
<div id="ques:tidy-12" class="question">
<p class="question-begin">
► Question 7.9
</p>
<div class="question-body">
<p>
Create a data frame containing only entries with a forklength &lt; 300.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>You can also combine expressions - for example to select only scalloped hammerheads that are also smaller that 300 cm you would use</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="welcome-to-the-tidyverse.html#cb141-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb141-2"><a href="welcome-to-the-tidyverse.html#cb141-2"></a><span class="st">  </span><span class="kw">filter</span>(Species <span class="op">==</span><span class="st"> "Sphyrna_lewini"</span> <span class="op">&amp;</span><span class="st"> </span>FL <span class="op">&lt;</span><span class="st"> </span><span class="dv">300</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 12
##   Site               Species        Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year
##   &lt;chr&gt;              &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Corpus_Christi_Bay Sphyrna_lewini F     &lt;NA&gt;             192   210   280        15     3     6     7  2017</code></pre>
<div id="ques:tidy-13" class="question">
<p class="question-begin">
► Question 7.10
</p>
<div class="question-body">
<p>
How would you subset a data frame to contain only entries for different species in the genus Carcharhinus that have a forklength larger than 500 cm?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Instead of entries having to fulfill two (or more) requirements, you might have a situation where you only want to retain rows that fulfill one or another argument. For example, if you wanted all entries that are either gafftops or a fork length smaller than 300 cm you could use the following code<label for="tufte-sn-32" class="margin-toggle sidenote-number">32</label><input type="checkbox" id="tufte-sn-32" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">32</span> When you are combining arguments you use <code>&amp;</code> to say “it must fulfill this <strong>AND</strong> this” or <code>|</code> (called the pipe) to say "it must fulfill this <strong>OR</strong> that.</span>:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="welcome-to-the-tidyverse.html#cb143-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb143-2"><a href="welcome-to-the-tidyverse.html#cb143-2"></a><span class="st">  </span><span class="kw">filter</span>(Species <span class="op">==</span><span class="st"> "Sphyrna_lewini"</span> <span class="op">|</span><span class="st"> </span>FL <span class="op">&lt;</span><span class="st"> </span><span class="dv">300</span>)</span></code></pre></div>
<pre><code>## # A tibble: 409 x 12
##    Site               Species       Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year
##    &lt;chr&gt;              &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Aransas_Bay        Bagre_marinus U     &lt;NA&gt;              NA   287   353        10     1    28     7  2015
##  2 Aransas_Bay        Bagre_marinus U     &lt;NA&gt;              NA   285   314        10     2    28     7  2015
##  3 Corpus_Christi_Bay Bagre_marinus U     &lt;NA&gt;              NA   299   348        10     1    30     7  2015
##  4 Corpus_Christi_Bay Bagre_marinus U     &lt;NA&gt;              NA   297   367        10     2    30     7  2015
##  5 Corpus_Christi_Bay Bagre_marinus U     &lt;NA&gt;              NA   298   362        10     3    30     7  2015
##  6 Corpus_Christi_Bay Bagre_marinus U     &lt;NA&gt;              NA   290   350        10     2    24     8  2015
##  7 Redfish_Bay        Bagre_marinus U     &lt;NA&gt;              NA   254   284        10     4     8     9  2015
##  8 Aransas_Bay        Bagre_marinus U     &lt;NA&gt;              NA    50   574        10     1    25     5  2016
##  9 Aransas_Bay        Bagre_marinus U     &lt;NA&gt;              NA   280   340         3     3    25     5  2016
## 10 Redfish_Bay        Bagre_marinus U     &lt;NA&gt;              NA   294   353        10     4    16     6  2016
## # ... with 399 more rows</code></pre>
<div id="ques:tidy-14" class="question">
<p class="question-begin">
► Question 7.11
</p>
<div class="question-body">
<p>
How would you select fish that have a forklength either smaller than 200 cm or larger than 300cm?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>The tidyverse has a central concept call “split-apply-combine”, which means that occasionally we want to group entries in a dataframe (split), do some sort of manipulation (apply), but end up with a single data frame (combine).</p>
<p><label for="tufte-mn-3" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-3" class="margin-toggle"><span class="marginnote"><span style="display: block;">The function <code>max()</code> can be used to get the maximum value for a vector of numbers. In this case, the vector we are looking at is the <code>FL</code> column of the <code>catch</code> dataframe.</span></span></p>
<p>For example, we might want to retain the entry with the longest fork length for each species. To do this we can use the <code>group_by()</code> function, then the <code>filter()</code> function.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="welcome-to-the-tidyverse.html#cb145-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb145-2"><a href="welcome-to-the-tidyverse.html#cb145-2"></a><span class="st">  </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span></span>
<span id="cb145-3"><a href="welcome-to-the-tidyverse.html#cb145-3"></a><span class="st">  </span><span class="kw">filter</span>(FL <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(FL)) <span class="op">%&gt;%</span></span>
<span id="cb145-4"><a href="welcome-to-the-tidyverse.html#cb145-4"></a><span class="st">  </span><span class="kw">ungroup</span>()</span></code></pre></div>
<pre><code>## # A tibble: 7 x 12
##   Site               Species          Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year
##   &lt;chr&gt;              &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Aransas_Bay        Rhizoprionodon_~ F     &lt;NA&gt;             580   637   790        10     2    25     8  2015
## 2 Aransas_Bay        Carcharhinus_le~ F     &lt;NA&gt;            1042  1140  1410        15     1    25     5  2016
## 3 Aransas_Bay        Carcharhinus_li~ F     &lt;NA&gt;             690   757   940        10     2    22     6  2017
## 4 Corpus_Christi_Bay Sphyrna_lewini   F     &lt;NA&gt;             520   578   770        10     1    21     8  2017
## 5 Corpus_Christi_Bay Carcharhinus_po~ U     &lt;NA&gt;             335   415   475        10     1     3     7  2018
## 6 Corpus_Christi_Bay Sciaenops_ocell~ U     &lt;NA&gt;              NA   841   950        10     3    25     9  2018
## 7 Corpus_Christi_Bay Synodus_foetens  U     &lt;NA&gt;              NA   173   185        10     3    30     6  2016</code></pre>
<p>This is also an example of how we can use the pipe (<code>%&gt;%</code>) to string a bunch of commands, in this example we are saying “take the object catch, and then group rows by Species and then for each group retain only the maximum forklength value for that group and then ungroup them again.”</p>
<div id="ques:tidy-15" class="question">
<p class="question-begin">
► Question 7.12
</p>
<div class="question-body">
<p>
How would you group rows by Species and then retain the individual caught on the largest hook size for each species?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>By doing that, you retained only one observation per species. That is actually a common process you might need to perform during exploratory analysis and can be achieved in a straightforward way using the function <code>distinct()</code>. For example, if we wanted to know all the years that had been sampled in we could use</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="welcome-to-the-tidyverse.html#cb147-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb147-2"><a href="welcome-to-the-tidyverse.html#cb147-2"></a><span class="st">  </span><span class="kw">distinct</span>(Year)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 1
##    Year
##   &lt;dbl&gt;
## 1  2015
## 2  2016
## 3  2017
## 4  2018</code></pre>
<p>Notice how that dropped all the other columns. You can switch that off usiing <code>.keep_all = FALSE</code>.</p>
<div id="ques:tidy-16" class="question">
<p class="question-begin">
► Question 7.13
</p>
<div class="question-body">
<p>
How would you produce a table with only one representative per species?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>You can also combine columns. For example if we wanted to determine the individual sets of the data set we could use</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="welcome-to-the-tidyverse.html#cb149-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb149-2"><a href="welcome-to-the-tidyverse.html#cb149-2"></a><span class="st">  </span><span class="kw">distinct</span>(Day, Month, Year, Set)</span></code></pre></div>
<pre><code>## # A tibble: 197 x 4
##      Set   Day Month  Year
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1    28     7  2015
##  2     2    28     7  2015
##  3     3    28     7  2015
##  4     4    28     7  2015
##  5     1    29     7  2015
##  6     2    29     7  2015
##  7     4    29     7  2015
##  8     1    30     7  2015
##  9     2    30     7  2015
## 10     3    30     7  2015
## # ... with 187 more rows</code></pre>
<div id="ques:tidy-17" class="question">
<p class="question-begin">
► Question 7.14
</p>
<div class="question-body">
<p>
How would you produce a table showing all the species caught per station using distinct(), presented as arranged alphabetically by Site and Species within Site?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="adding-new-variables" class="section level2">
<h2>
<span class="header-section-number">7.5</span> Adding new variables<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('adding-new-variables')" onmouseout="reset_tooltip('adding-new-variables-tooltip')"><span class="tooltiptext" id="adding-new-variables-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Turns out selecting columns and filtering based on content in rows is pretty straightforward. But frequently when we are processing our raw data sets we end up wanting to compute additional metrics or use the existing raw data to create new categories.</p>
<p>The function <code>mutate()</code> can be used to create new columns - frequently based on columns already existing in the data frame. This is a very powerful function with endless possibilities, but we are going to stick to some of the basics for now<label for="tufte-sn-33" class="margin-toggle sidenote-number">33</label><input type="checkbox" id="tufte-sn-33" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">33</span> Rest assured if your answer is “Oh, could I …” the answer is “Yes”.</span>.</p>
<p>Let’s say you wanted create a column that contained the difference between the fork length and the stretch total length:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="welcome-to-the-tidyverse.html#cb151-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb151-2"><a href="welcome-to-the-tidyverse.html#cb151-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">difference =</span> STL <span class="op">-</span><span class="st"> </span>FL)</span></code></pre></div>
<pre><code>## # A tibble: 2,325 x 13
##    Site        Species       Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year difference
##    &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
##  1 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   287   353        10     1    28     7  2015         66
##  2 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   425   495        10     1    28     7  2015         70
##  3 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   502        15     1    28     7  2015         86
##  4 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   507        10     1    28     7  2015         91
##  5 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   418   510        15     1    28     7  2015         92
##  6 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   434   515        10     1    28     7  2015         81
##  7 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   427   520        15     1    28     7  2015         93
##  8 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   446   532        10     1    28     7  2015         86
##  9 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   465   538        10     1    28     7  2015         73
## 10 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   450   539        10     1    28     7  2015         89
## # ... with 2,315 more rows</code></pre>
<p>You should now have a column called <code>difference</code> at the end of the data frame<label for="tufte-sn-34" class="margin-toggle sidenote-number">34</label><input type="checkbox" id="tufte-sn-34" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">34</span> Instead of <code>-</code> you can of course use <code>+</code> to add , <code>*</code> to multiple, and <code>/</code> to divide values when creating a new column.</span>.</p>
<div id="ques:tidy-18" class="question">
<p class="question-begin">
► Question 7.15
</p>
<div class="question-body">
<p>
How would you create a new column called ratio, that is the ratio of the fork to stretch total length?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>You can also create a column that contains a logical value (<code>TRUE</code>/<code>FALSE</code>). For example we might need a column that indicates if the Sex is unknown.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="welcome-to-the-tidyverse.html#cb153-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb153-2"><a href="welcome-to-the-tidyverse.html#cb153-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">unknown_sex =</span> Sex <span class="op">==</span><span class="st"> "U"</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2,325 x 13
##    Site        Species       Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year unknown_sex
##    &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;      
##  1 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   287   353        10     1    28     7  2015 TRUE       
##  2 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   425   495        10     1    28     7  2015 TRUE       
##  3 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   502        15     1    28     7  2015 TRUE       
##  4 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   507        10     1    28     7  2015 TRUE       
##  5 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   418   510        15     1    28     7  2015 TRUE       
##  6 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   434   515        10     1    28     7  2015 TRUE       
##  7 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   427   520        15     1    28     7  2015 TRUE       
##  8 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   446   532        10     1    28     7  2015 TRUE       
##  9 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   465   538        10     1    28     7  2015 TRUE       
## 10 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   450   539        10     1    28     7  2015 TRUE       
## # ... with 2,315 more rows</code></pre>
<p>You should know have a column called <code>unknown_sex</code> where if the animal that was caught was not sexed contains the value <code>TRUE</code>, if it was identified as male or female it would say <code>FALSE</code>.</p>
<div id="ques:tidy-19" class="question">
<p class="question-begin">
► Question 7.16
</p>
<div class="question-body">
<p>
How would you create a new column called post_2017 that is TRUE if fish were caught after 2017?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><label for="tufte-mn-4" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-4" class="margin-toggle"><span class="marginnote"><span style="display: block;">Note: For that last one, a “conditional mutate” using an <code>ifelse</code> statement (if this then do that, else do that) could have come in handy. Another option is <code>case_when()</code> which allows you to create multiple sets of conditions as opposed to <code>ifelse</code> which sets up a <code>TRUE</code>/<code>FALSE</code> dichotomy (file this information away for “maybe useful later”).</span></span></p>
<p>Many problems in data science require you to split your data set into subsets according to some grouping variable, apply a function, and then combine the results. <code>dplyr</code> is designed to make this straightforward; you have already sen an example of this while you were learning about <code>filter()</code>. Similarly, you can combine <code>mutate()</code> with <code>group_by()</code>.</p>
<p><label for="tufte-mn-5" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-5" class="margin-toggle"><span class="marginnote"><span style="display: block;">The function <code>mean()</code> will calculate the mean value of a vector of numbers, the argument <code>na.rm=TRUE</code> tells the function to ignore any <code>NA</code>-values in the data set.</span></span></p>
<p>For example, let’s say you wanted to create a column that is the difference between the fork length of an individual and the mean fork length of <em>that species</em>.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="welcome-to-the-tidyverse.html#cb155-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb155-2"><a href="welcome-to-the-tidyverse.html#cb155-2"></a><span class="st">  </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span></span>
<span id="cb155-3"><a href="welcome-to-the-tidyverse.html#cb155-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">diff_mean =</span> FL<span class="op">-</span><span class="kw">mean</span>(FL, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 2,325 x 13
## # Groups:   Species [14]
##    Site        Species       Sex   Observed_Stage   PCL    FL   STL Hook_Size   Set   Day Month  Year diff_mean
##    &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
##  1 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   287   353        10     1    28     7  2015  -146.   
##  2 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   425   495        10     1    28     7  2015    -8.35 
##  3 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   502        15     1    28     7  2015   -17.4  
##  4 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   416   507        10     1    28     7  2015   -17.4  
##  5 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   418   510        15     1    28     7  2015   -15.4  
##  6 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   434   515        10     1    28     7  2015     0.646
##  7 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   427   520        15     1    28     7  2015    -6.35 
##  8 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   446   532        10     1    28     7  2015    12.6  
##  9 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   465   538        10     1    28     7  2015    31.6  
## 10 Aransas_Bay Bagre_marinus U     &lt;NA&gt;              NA   450   539        10     1    28     7  2015    16.6  
## # ... with 2,315 more rows</code></pre>
<div id="ques:tidy-20" class="question">
<p class="question-begin">
► Question 7.17
</p>
<div class="question-body">
<p>
How would you create a new column called that contains the difference between the fork length of an individual and the mean fork length of that species for each month?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="create-new-data.frame-based-on-another" class="section level2">
<h2>
<span class="header-section-number">7.6</span> Create new <code>data.frame</code> based on another<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('create-new-data.frame-based-on-another')" onmouseout="reset_tooltip('create-new-data.frame-based-on-another-tooltip')"><span class="tooltiptext" id="create-new-data.frame-based-on-another-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Not infrequently we are more interested in summary stats of a data set rather than all the raw data - <code>Tidyverse</code> got you covered with the function <code>summarize()</code>.</p>
<p>For example, we might want to calculate the mean and standard deviation of the measured fork length.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="welcome-to-the-tidyverse.html#cb157-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb157-2"><a href="welcome-to-the-tidyverse.html#cb157-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_FL =</span> <span class="kw">mean</span>(FL, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb157-3"><a href="welcome-to-the-tidyverse.html#cb157-3"></a>            <span class="dt">sd_FL =</span> <span class="kw">sd</span>(FL, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   mean_FL sd_FL
##     &lt;dbl&gt; &lt;dbl&gt;
## 1    406.  103.</code></pre>
<div id="ques:tidy-21" class="question">
<p class="question-begin">
► Question 7.18
</p>
<div class="question-body">
<p>
How could you use summarize to get the maximum forklength?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><label for="tufte-sn-35" class="margin-toggle sidenote-number">35</label><input type="checkbox" id="tufte-sn-35" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">35</span> Hint: Remember earlier we used the function max() to get a maximum value.</span></p>
<p>That’s cool but really we could have also just used</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="welcome-to-the-tidyverse.html#cb159-1"></a><span class="kw">mean</span>(catch<span class="op">$</span>FL, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 405.9179</code></pre>
<p>to get that information.</p>
<p><code>summarize</code> becomes especially powerful once we leverage <code>group_by()</code> to start calculating summary stats for entries grouped by a grouping variable.</p>
<p>For example we can calculate summary stats by species:</p>
<pre><code>## # A tibble: 14 x 6
##    Species                    mean_FL median_FL max_FL min_FL sd_FL
##    &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 Bagre_marinus                 433.      445     575     45  65.4
##  2 Carcharhinus_brevipinna       644.      648     900    489  69.2
##  3 Carcharhinus_leucas           769       702    1140    624 167. 
##  4 Carcharhinus_limbatus         613.      579     757    538 101. 
##  5 Carcharhinus_porosus          415       415     415    415  NA  
##  6 Hypanus_americanus            NaN        NA    -Inf    Inf  NA  
##  7 Hypanus_sabina                NaN        NA    -Inf    Inf  NA  
##  8 Rhinoptera_bonasus            NaN        NA    -Inf    Inf  NA  
##  9 Rhizoprionodon_terraenovae    412       396     637    306  73.6
## 10 Sciades_felis                 299.      297     480    102  41.9
## 11 Sciaenops_ocellatus           793       793     841    745  67.9
## 12 Sphyrna_lewini                471.      548.    578    210 174. 
## 13 Sphyrna_tiburo                622.      605     861    370 114. 
## 14 Synodus_foetens               173       173     173    173  NA</code></pre>
<div id="ques:tidy-22" class="question">
<p class="question-begin">
► Question 7.19
</p>
<div class="question-body">
<p>
If you look closely you should see that you are getting a few NA, NaN, -Inf, and Inf values - any guesses why? You might want to pull up the catch data frame in the view panel to see what is going on with those species.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:tidy-23" class="question">
<p class="question-begin">
► Question 7.20
</p>
<div class="question-body">
<p>
How could you use summarize calculate a range of summary stats for the stretch total length for individuals grouped by sex?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>So far, we have been manipulating our data frame using code and printing it directly to the console (and our rmarkdown). This can be useful for example to generate tables for reports but frequently we want to create a new object that has been manipulated according to our code and then we will further process, visualize, or analyze that dataframe down the line.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="welcome-to-the-tidyverse.html#cb162-1"></a>summary &lt;-<span class="st"> </span>catch <span class="op">%&gt;%</span></span>
<span id="cb162-2"><a href="welcome-to-the-tidyverse.html#cb162-2"></a><span class="st">  </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span></span>
<span id="cb162-3"><a href="welcome-to-the-tidyverse.html#cb162-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_FL =</span> <span class="kw">mean</span>(FL, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb162-4"><a href="welcome-to-the-tidyverse.html#cb162-4"></a>           <span class="dt">median_FL =</span> <span class="kw">median</span>(FL, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb162-5"><a href="welcome-to-the-tidyverse.html#cb162-5"></a>           <span class="dt">max_FL =</span> <span class="kw">max</span>(FL, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb162-6"><a href="welcome-to-the-tidyverse.html#cb162-6"></a>           <span class="dt">min_FL =</span> <span class="kw">min</span>(FL, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb162-7"><a href="welcome-to-the-tidyverse.html#cb162-7"></a>           <span class="dt">sd_FL =</span> <span class="kw">sd</span>(FL, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb162-8"><a href="welcome-to-the-tidyverse.html#cb162-8"></a><span class="st">  </span><span class="kw">ungroup</span>()</span></code></pre></div>
<p>When you execute this code, you’ll notice that the code (and probably a warning) is printed to the console but there is no output. Instead, if you look at the environment in the top right corner you should now see a new object called <code>summary</code>. Per usual, you can pull that up in the Editor/View pane (top left) using either <code>View(summary)</code> in the console or by clicking on the object in the environment.</p>
<p>You will be presenting results in reports over the course of the semester, when you <code>knit</code> an <code>Rmarkdown</code> file you will get tables formatted in a standard way according to defaults in the resulting <code>html</code> file. If you want finer control over the output, you can use the <code>kable()</code> function. This will allow you to further format the table, for example, you may specify the number of digits printed using the argument <code>digits =</code> and add a caption using <code>caption = "caption"</code>.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="welcome-to-the-tidyverse.html#cb163-1"></a><span class="kw">kable</span>(</span>
<span id="cb163-2"><a href="welcome-to-the-tidyverse.html#cb163-2"></a>  summary,</span>
<span id="cb163-3"><a href="welcome-to-the-tidyverse.html#cb163-3"></a>  <span class="dt">digits =</span> <span class="dv">1</span>,</span>
<span id="cb163-4"><a href="welcome-to-the-tidyverse.html#cb163-4"></a>  <span class="dt">caption =</span> <span class="st">"Summary statistics of forklength for each species."</span></span>
<span id="cb163-5"><a href="welcome-to-the-tidyverse.html#cb163-5"></a>)</span></code></pre></div>
<p><!--
<caption>--><span class="marginnote shownote"><span id="tab:unnamed-chunk-105">Table 7.1: </span>Summary statistics of forklength for each species.</span><!--</caption>--></p>
<table>
<thead><tr class="header">
<th align="left">Species</th>
<th align="right">mean_FL</th>
<th align="right">median_FL</th>
<th align="right">max_FL</th>
<th align="right">min_FL</th>
<th align="right">sd_FL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Bagre_marinus</td>
<td align="right">433.4</td>
<td align="right">445.0</td>
<td align="right">575</td>
<td align="right">45</td>
<td align="right">65.4</td>
</tr>
<tr class="even">
<td align="left">Carcharhinus_brevipinna</td>
<td align="right">643.7</td>
<td align="right">648.0</td>
<td align="right">900</td>
<td align="right">489</td>
<td align="right">69.2</td>
</tr>
<tr class="odd">
<td align="left">Carcharhinus_leucas</td>
<td align="right">769.0</td>
<td align="right">702.0</td>
<td align="right">1140</td>
<td align="right">624</td>
<td align="right">167.3</td>
</tr>
<tr class="even">
<td align="left">Carcharhinus_limbatus</td>
<td align="right">613.2</td>
<td align="right">579.0</td>
<td align="right">757</td>
<td align="right">538</td>
<td align="right">101.0</td>
</tr>
<tr class="odd">
<td align="left">Carcharhinus_porosus</td>
<td align="right">415.0</td>
<td align="right">415.0</td>
<td align="right">415</td>
<td align="right">415</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Hypanus_americanus</td>
<td align="right">NaN</td>
<td align="right">NA</td>
<td align="right">-Inf</td>
<td align="right">Inf</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Hypanus_sabina</td>
<td align="right">NaN</td>
<td align="right">NA</td>
<td align="right">-Inf</td>
<td align="right">Inf</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Rhinoptera_bonasus</td>
<td align="right">NaN</td>
<td align="right">NA</td>
<td align="right">-Inf</td>
<td align="right">Inf</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Rhizoprionodon_terraenovae</td>
<td align="right">412.0</td>
<td align="right">396.0</td>
<td align="right">637</td>
<td align="right">306</td>
<td align="right">73.6</td>
</tr>
<tr class="even">
<td align="left">Sciades_felis</td>
<td align="right">298.9</td>
<td align="right">297.0</td>
<td align="right">480</td>
<td align="right">102</td>
<td align="right">41.9</td>
</tr>
<tr class="odd">
<td align="left">Sciaenops_ocellatus</td>
<td align="right">793.0</td>
<td align="right">793.0</td>
<td align="right">841</td>
<td align="right">745</td>
<td align="right">67.9</td>
</tr>
<tr class="even">
<td align="left">Sphyrna_lewini</td>
<td align="right">470.8</td>
<td align="right">547.5</td>
<td align="right">578</td>
<td align="right">210</td>
<td align="right">174.4</td>
</tr>
<tr class="odd">
<td align="left">Sphyrna_tiburo</td>
<td align="right">621.5</td>
<td align="right">605.0</td>
<td align="right">861</td>
<td align="right">370</td>
<td align="right">114.4</td>
</tr>
<tr class="even">
<td align="left">Synodus_foetens</td>
<td align="right">173.0</td>
<td align="right">173.0</td>
<td align="right">173</td>
<td align="right">173</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="combining-verbs" class="section level2">
<h2>
<span class="header-section-number">7.7</span> Combining verbs<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('combining-verbs')" onmouseout="reset_tooltip('combining-verbs-tooltip')"><span class="tooltiptext" id="combining-verbs-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>We’ve already combined most of our <code>dplyr</code> verbs with <code>group_by()</code>. When you are wrangling data you will find that making use of the pipe (<code>%&gt;%</code>) to combine <code>select()</code>, <code>filter()</code>, <code>mutate()</code>, and <code>summarize()</code> as a series of commands will be necessary to get your data set in the correct format and further process it.</p>
<div id="ques:tidy-24" class="question">
<p class="question-begin">
► Question 7.21
</p>
<div class="question-body">
<p>Copy this code into your <code>Rmarkdown</code> file and execute the code chunk. Then describe what each line is doing to manipulate the data frame.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="welcome-to-the-tidyverse.html#cb164-1"></a>catch <span class="op">%&gt;%</span></span>
<span id="cb164-2"><a href="welcome-to-the-tidyverse.html#cb164-2"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>PCL, <span class="op">-</span>Hook_Size) <span class="op">%&gt;%</span></span>
<span id="cb164-3"><a href="welcome-to-the-tidyverse.html#cb164-3"></a><span class="st">  </span><span class="kw">separate</span>(Species, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">"genus"</span>, <span class="st">"species"</span>), <span class="dt">remove =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb164-4"><a href="welcome-to-the-tidyverse.html#cb164-4"></a><span class="st">  </span><span class="kw">unite</span>(Date, Day, Month, Year) <span class="op">%&gt;%</span></span>
<span id="cb164-5"><a href="welcome-to-the-tidyverse.html#cb164-5"></a><span class="st">  </span><span class="kw">filter</span>(genus <span class="op">==</span><span class="st"> "Carcharhinus"</span> <span class="op">&amp;</span><span class="st"> </span>Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"F"</span>, <span class="st">"M"</span>)) <span class="op">%&gt;%</span></span>
<span id="cb164-6"><a href="welcome-to-the-tidyverse.html#cb164-6"></a><span class="st">  </span><span class="kw">group_by</span>(Site, genus, species, Sex) <span class="op">%&gt;%</span></span>
<span id="cb164-7"><a href="welcome-to-the-tidyverse.html#cb164-7"></a><span class="st">  </span><span class="kw">filter</span>(FL <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(FL)) <span class="op">%&gt;%</span></span>
<span id="cb164-8"><a href="welcome-to-the-tidyverse.html#cb164-8"></a><span class="st">  </span><span class="kw">arrange</span>(species)</span></code></pre></div>
<pre><code>## # A tibble: 11 x 9
## # Groups:   Site, genus, species, Sex [11]
##    Site               genus        species    Sex   Observed_Stage    FL   STL   Set Date      
##    &lt;chr&gt;              &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     
##  1 Aransas_Bay        Carcharhinus brevipinna M     &lt;NA&gt;             640   792     3 22_9_2015 
##  2 Redfish_Bay        Carcharhinus brevipinna F     &lt;NA&gt;             900  1090     1 16_6_2016 
##  3 Redfish_Bay        Carcharhinus brevipinna M     &lt;NA&gt;             882  1092     2 16_6_2016 
##  4 Corpus_Christi_Bay Carcharhinus brevipinna M     &lt;NA&gt;             699   860     1 25_10_2017
##  5 Corpus_Christi_Bay Carcharhinus brevipinna F     &lt;NA&gt;             704   880     4 2_10_2018 
##  6 Aransas_Bay        Carcharhinus leucas     F     &lt;NA&gt;            1140  1410     1 25_5_2016 
##  7 Corpus_Christi_Bay Carcharhinus leucas     F     YOY              694   854     2 10_6_2016 
##  8 Aransas_Bay        Carcharhinus leucas     M     &lt;NA&gt;             812   912     4 22_9_2016 
##  9 Redfish_Bay        Carcharhinus leucas     M     &lt;NA&gt;             840  1010     3 29_9_2016 
## 10 Aransas_Bay        Carcharhinus limbatus   F     &lt;NA&gt;             757   940     2 22_6_2017 
## 11 Corpus_Christi_Bay Carcharhinus limbatus   M     &lt;NA&gt;             610   770     2 30_8_2018</code></pre>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:tidy-25" class="question">
<p class="question-begin">
► Question 7.22
</p>
<div class="question-body">
<p>Generate the code that will manipulate the data frame as follows<label for="tufte-sn-36" class="margin-toggle sidenote-number">36</label><input type="checkbox" id="tufte-sn-36" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">36</span> some bullet points may require more than one line of code; you do not have to perform the steps in the sequence presented, play around a little bit to see how to code this more efficiently</span>:</p>
<p>Challenge 1:</p>
<ul>
<li>order columns so Day, Month, Year, Set are at the beginning.</li>
<li>retain all male individuals in the genus Carcharhinus.</li>
<li>get rid of columns containing information on observed stage, precaudal length, and hook size</li>
</ul>
<p>Challenge 2:</p>
<ul>
<li>create a new variable called Set_ID consisting of Day, Month, Year, and Set number.</li>
<li>determine the number of individuals per species per set<label for="tufte-sn-37" class="margin-toggle sidenote-number">37</label><input type="checkbox" id="tufte-sn-37" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">37</span> There is a function called <code>n()</code> that allows us to count rows fulfilling a specific condition</span>.</li>
</ul>
<p>Challenge 3:</p>
<ul>
<li>remove all gafftops</li>
<li>calculate mean forklength for each species by sex and month of the year.</li>
</ul>
<p>format each data frame in a separate code chunk.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="producing-tidy-data-sets" class="section level2">
<h2>
<span class="header-section-number">7.8</span> Producing tidy data sets<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('producing-tidy-data-sets')" onmouseout="reset_tooltip('producing-tidy-data-sets-tooltip')"><span class="tooltiptext" id="producing-tidy-data-sets-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>The last set up functions that we need to get comfortable with allow us to create tidy data sets.</p>
<div id="ques:tidy-26" class="question">
<p class="question-begin">
► Question 7.23
</p>
<div class="question-body">
<p>
List the three characteristics of a tidy data set. Explain why a tidy data set is sometimes also describe as a long data set.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:tidy-27" class="question">
<p class="question-begin">
► Question 7.24
</p>
<div class="question-body">
<p>
Take a look at our data set and argue whether or not it is a tidy data set. The easiest way to do this is to determine if it fullfills all the characteristics.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Let’s quickly reformat our catch data as follows</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="welcome-to-the-tidyverse.html#cb166-1"></a>catch_length &lt;-<span class="st"> </span>catch <span class="op">%&gt;%</span></span>
<span id="cb166-2"><a href="welcome-to-the-tidyverse.html#cb166-2"></a><span class="st">  </span><span class="kw">unite</span>(SetID, Year, Month, Day, Set, <span class="dt">sep =</span> <span class="st">"_"</span>) <span class="op">%&gt;%</span></span>
<span id="cb166-3"><a href="welcome-to-the-tidyverse.html#cb166-3"></a><span class="st">  </span><span class="kw">select</span>(SetID, Site, Species, Sex, PCL, FL, STL)</span>
<span id="cb166-4"><a href="welcome-to-the-tidyverse.html#cb166-4"></a></span>
<span id="cb166-5"><a href="welcome-to-the-tidyverse.html#cb166-5"></a><span class="kw">head</span>(catch_length)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 7
##   SetID       Site        Species       Sex     PCL    FL   STL
##   &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 2015_7_28_1 Aransas_Bay Bagre_marinus U        NA   287   353
## 2 2015_7_28_1 Aransas_Bay Bagre_marinus U        NA   425   495
## 3 2015_7_28_1 Aransas_Bay Bagre_marinus U        NA   416   502
## 4 2015_7_28_1 Aransas_Bay Bagre_marinus U        NA   416   507
## 5 2015_7_28_1 Aransas_Bay Bagre_marinus U        NA   418   510
## 6 2015_7_28_1 Aransas_Bay Bagre_marinus U        NA   434   515</code></pre>
<p>We can turn this into a tidy data set using <code>pivot_longer()</code>. To do that we have to identify columns that will be used as the key (<code>cols =</code>) and then name the column that will hold those values (<code>names_to()</code>) and the column that will hold the value (<code>values_to()</code>).</p>
<p>So in this case <code>Measurement</code> would be the key. This column will let us know whether an observation (row) is pre-caudal length, fork length, or stretch total length.</p>
<p>We will designate another column <code>Length</code> to hold the values for each measurement.</p>
<p>We can identify the columns that need to be gathered either by name or since we have re-arranged our dataframe so they are the last columns but column number.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="welcome-to-the-tidyverse.html#cb168-1"></a>tidy_length &lt;-<span class="st"> </span>catch_length <span class="op">%&gt;%</span></span>
<span id="cb168-2"><a href="welcome-to-the-tidyverse.html#cb168-2"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">names_to =</span> <span class="st">"Measurement"</span>, <span class="dt">values_to =</span> <span class="st">"Length"</span>, <span class="dt">cols =</span> <span class="dv">5</span><span class="op">:</span><span class="dv">7</span>)</span></code></pre></div>
<div id="ques:tidy-28" class="question">
<p class="question-begin">
► Question 7.25
</p>
<div class="question-body">
<p>
Briefly outline advantages to using tidy data sets.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>With this data set it would be straightforward for us to e.g. calculate mean values for each length measurement by species.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="welcome-to-the-tidyverse.html#cb169-1"></a>tidy_length <span class="op">%&gt;%</span></span>
<span id="cb169-2"><a href="welcome-to-the-tidyverse.html#cb169-2"></a><span class="st">  </span><span class="kw">group_by</span>(Species, Measurement) <span class="op">%&gt;%</span></span>
<span id="cb169-3"><a href="welcome-to-the-tidyverse.html#cb169-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 42 x 3
## # Groups:   Species [14]
##    Species                 Measurement  mean
##    &lt;chr&gt;                   &lt;chr&gt;       &lt;dbl&gt;
##  1 Bagre_marinus           FL           433.
##  2 Bagre_marinus           PCL          NaN 
##  3 Bagre_marinus           STL          517.
##  4 Carcharhinus_brevipinna FL           644.
##  5 Carcharhinus_brevipinna PCL          583.
##  6 Carcharhinus_brevipinna STL          804.
##  7 Carcharhinus_leucas     FL           769 
##  8 Carcharhinus_leucas     PCL          691.
##  9 Carcharhinus_leucas     STL          936.
## 10 Carcharhinus_limbatus   FL           613.
## # ... with 32 more rows</code></pre>
<p>Despite all the advantages of tidy data sets you can see from the table above that frequently when we are presenting results in a table it may be advantageous in terms of layout to have a non-tidy format.</p>
<p>This can be done using <code>pivot_wider()</code> which essentially works like <code>pivot_longer()</code> but in reverse. You designate which column is the key (<code>names_from =</code>), i.e. these will become the column names in the new table.</p>
<p>Then you need to identify which column in your current data frame contains the values that should be filled out/spread into the columns that will be generated from your key (<code>values_from =</code>).</p>
<p>Since we don’t have values for precaudal length, we probably want to use <code>filter()</code> to remove those rows first.</p>
<p><label for="tufte-mn-6" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-6" class="margin-toggle"><span class="marginnote"><span style="display: block;">More notes on naming things … recall, that we said that filenames should not contain spaces or special characters? We set similar rules for naming objects. Well, column names is a similar conundrum. Including spaces or species characters as a column name creates problems when we are using functions like <code>select()</code> to subset by column name or <code>mutate()</code> to create new columns based on exisiting columns. Similarly, if the column name is a number you will have problems. If you do have unconvential column names you can rename them using <code>rename()</code> or you can use backticks and either side of the name to indicate that it is a column name.</span></span></p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="welcome-to-the-tidyverse.html#cb171-1"></a>tidy_length <span class="op">%&gt;%</span></span>
<span id="cb171-2"><a href="welcome-to-the-tidyverse.html#cb171-2"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>Measurement <span class="op">==</span><span class="st"> "PCL"</span>) <span class="op">%&gt;%</span></span>
<span id="cb171-3"><a href="welcome-to-the-tidyverse.html#cb171-3"></a><span class="st">  </span><span class="kw">group_by</span>(Species, Measurement) <span class="op">%&gt;%</span></span>
<span id="cb171-4"><a href="welcome-to-the-tidyverse.html#cb171-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb171-5"><a href="welcome-to-the-tidyverse.html#cb171-5"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> <span class="st">"Measurement"</span>, <span class="dt">values_from =</span> <span class="st">"mean"</span>)</span></code></pre></div>
<pre><code>## # A tibble: 14 x 3
## # Groups:   Species [14]
##    Species                       FL   STL
##    &lt;chr&gt;                      &lt;dbl&gt; &lt;dbl&gt;
##  1 Bagre_marinus               433.  517.
##  2 Carcharhinus_brevipinna     644.  804.
##  3 Carcharhinus_leucas         769   936.
##  4 Carcharhinus_limbatus       613.  776.
##  5 Carcharhinus_porosus        415   475 
##  6 Hypanus_americanus          NaN   954.
##  7 Hypanus_sabina              NaN   349.
##  8 Rhinoptera_bonasus          NaN   819 
##  9 Rhizoprionodon_terraenovae  412   510.
## 10 Sciades_felis               299.  343.
## 11 Sciaenops_ocellatus         793   932.
## 12 Sphyrna_lewini              471.  628 
## 13 Sphyrna_tiburo              622.  792.
## 14 Synodus_foetens             173   185</code></pre>
<div id="ques:tidy-29" class="question">
<p class="question-begin">
► Question 7.26
</p>
<div class="question-body">
<p>
Calculate the number of individuals per species caught per month in 2018 and present that data in a wide formate to make it easy to compare the number of species (species) per month (columns). As a bonus create an additional column with total catch of that species for 2018.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>

</div>
</div></body></html>

<p style="text-align: center;">
<a href="intro-to-data-frames.html"><button class="btn btn-default">Previous</button></a>
<a href="catch-data-analysis.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2021-09-30
 using 
R version 4.0.2 (2020-06-22)
</p>
</div>
</div>



</body>
</html>

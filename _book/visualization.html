<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="14 Visualization | Data Science for the Natural Environment (FA21)" />
<meta property="og:type" content="book" />





<meta name="author" content="Shannon J. O’Leary" />

<meta name="date" content="2021-09-18" />


<meta name="description" content="14 Visualization | Data Science for the Natural Environment (FA21)">

<title>14 Visualization | Data Science for the Natural Environment (FA21)</title>

<link href="libs/tufte-css/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css/msmb.css" rel="stylesheet" />
<script src="libs/accessible-code-block/empty-anchor.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>



<link rel="stylesheet" href="msmb.css" type="text/css" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script>
function copy_link(id) {
  var dummy = document.createElement('input'),
  text = window.location.href.split(/[?#]/)[0] + '#' + id;
  document.body.appendChild(dummy);
  dummy.value = text;
  dummy.select();
  document.execCommand('copy');
  document.body.removeChild(dummy);
  
  var tooltip = document.getElementById(id + '-tooltip');
  tooltip.innerHTML = 'Copied!';
}

function reset_tooltip(id) {
  var tooltip = document.getElementById(id);
  tooltip.innerHTML = 'Copy link';
}
</script>

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Data Science for the Natural Environment (FA21)<p><p class="author">Shannon J. O'Leary</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Overview</a>
<a href="what-even-is-data-science.html"><span class="toc-section-number">1</span> What even is data science?</a>
<a href="installing-rrstudio.html"><span class="toc-section-number">2</span> Installing R/Rstudio</a>
<a href="project-management-and-rmarkdown-basics.html"><span class="toc-section-number">3</span> Project management and Rmarkdown Basics</a>
<a href="r-functions-objects-vectors-oh-my.html"><span class="toc-section-number">4</span> R: Functions, Objects, Vectors - oh my!</a>
<a href="identifying-essential-fish-habitat-shark-nurseries-on-the-texas-coast.html"><span class="toc-section-number">5</span> Identifying essential fish habitat: Shark Nurseries on the Texas coast</a>
<a href="intro-to-data-frames.html"><span class="toc-section-number">6</span> Intro to data frames</a>
<a href="welcome-to-the-tidyverse.html"><span class="toc-section-number">7</span> Welcome to the tidyverse</a>
<a href="catch-data-analysis.html"><span class="toc-section-number">8</span> Catch data analysis</a>
<a href="scientific-misconduct-and-the-reproducible-crisis.html"><span class="toc-section-number">9</span> Scientific misconduct and the reproducible crisis</a>
<a href="responsible-research-is-reproducible-research.html"><span class="toc-section-number">10</span> Responsible Research is Reproducible Research</a>
<a href="project-management-revisited.html"><span class="toc-section-number">11</span> Project Management Revisited</a>
<a href="data-wrangling-tidy-data-revisited.html"><span class="toc-section-number">12</span> Data Wrangling &amp; Tidy data Revisited</a>
<a href="climate-change.html"><span class="toc-section-number">13</span> Climate Change</a>
<a id="active-page" href="visualization.html"><span class="toc-section-number">14</span> Visualization</a><ul class="toc-sections">
<li class="toc"><a href="#a-grammar-of-graphics"> A grammar of graphics</a></li>
<li class="toc"><a href="#building-plots"> Building plots</a></li>
<li class="toc"><a href="#faceting-plots"> Faceting plots</a></li>
<li class="toc"><a href="#customizing-plots"> Customizing plots</a></li>
<li class="toc"><a href="#arranging-plots"> Arranging plots</a></li>
<li class="toc"><a href="#exporting-plots"> Exporting Plots</a></li>
<li class="toc"><a href="#more-plots"> More Plots!</a></li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div id="visualization" class="section level1">
<h1>
<span class="header-section-number">14</span> Visualization</h1>
<p><strong>Learning Objectives</strong></p>
<p>After completing this tutorial you should be able to</p>
<ul>
<li>apply the grammar of graphics implemented in <code>ggplot</code> to create plots.</li>
<li>use core geometries implemented <code>ggplot</code> to produce scatter plots (<code>geom_point()</code>), line plots (<code>geom_line()</code>), bar plots (<code>geom_bar()</code>), histograms (<code>geom_histogram</code>), and box plots (<code>geom_boxplot()</code>).</li>
<li>customize aesthetics of a plot (including color and axis labels).</li>
<li>describe what faceting is and apply this to a plot.</li>
<li>combine multiple plots in a multi-panel plot using <code>patchwork</code> and save plots to file.</li>
</ul>
<p>You should have a <code>IntroVisualization.Rmd</code> in your project directory. Use that file to work through this set of activities - you will hand in your rendered (“knitted”) Rmarkdown file as your homework assignment. In the <code>YAML</code> header, change the author to your name and make your formatting decisions such as theme, including a table of contents etc. Apply your <code>Rmarkdown</code> skills to format your “report” that you will hand in. Code chunks should have comments<label for="tufte-sn-1" class="margin-toggle sidenote-number">1</label><input type="checkbox" id="tufte-sn-1" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">1</span> You should do this regardless of whether you are adding code yourself or if you are using code from our manual, even if it isn’t commented in the manual … you may of course add as many comments as you need to be able to recall what you did.</span>, add answers to questions in plain text (not as code in chunks), use headers intentionally, and of course you have options like bullet points etc. as well.</p>
<p>Let’s start by loading the packages we will need for this set of activities.</p>
<p>Before you can load all the libraries we need, you will need to install the <code>patchwork</code> package using <code>install.package("patchwork")</code>. You only need to do this once, the easiest wat to do this is to simply run that function directly in the console.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="visualization.html#cb1-1"></a><span class="co"># load libraries</span></span>
<span id="cb1-2"><a href="visualization.html#cb1-2"></a><span class="kw">library</span>(knitr)</span>
<span id="cb1-3"><a href="visualization.html#cb1-3"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="visualization.html#cb1-4"></a><span class="kw">library</span>(patchwork)</span>
<span id="cb1-5"><a href="visualization.html#cb1-5"></a></span>
<span id="cb1-6"><a href="visualization.html#cb1-6"></a><span class="co"># turn of sci notation</span></span>
<span id="cb1-7"><a href="visualization.html#cb1-7"></a><span class="kw">options</span>(<span class="dt">scipen=</span><span class="dv">999</span>)</span></code></pre></div>
<div id="a-grammar-of-graphics" class="section level2">
<h2>
<span class="header-section-number">14.1</span> A grammar of graphics<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('a-grammar-of-graphics')" onmouseout="reset_tooltip('a-grammar-of-graphics-tooltip')"><span class="tooltiptext" id="a-grammar-of-graphics-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Now that we are confident(ish) in our data wrangling the next step is learning how we can visualize our data for exploration and for communication.</p>
<p>Exploratory analysis is an important component of data science as it not only gives you an overview of what information is contained in a data set, but it can also help you refine the question you are asking. Finally, once you have refined and completed an analysis, visualizations are a key component to communicate your results.</p>
<p><code>ggplot2</code> is the core package of the <code>tidyverse</code> used for visualization. Similar to <code>tidyr</code> and <code>dplyr</code> having been built on the concept of a tidy data set, <code>ggplot2</code> was built on a framework which follows a layered approach to describe and/or build any type of visualization in a structure way termed the “grammar of graphics”.</p>
<p>The grammar of graphics breaks down the components of any visualization into seven components.</p>
<ul>
<li>
<strong>Data</strong> - the component of data set to visualize</li>
<li>
<strong>Aesthetics</strong> including axes, plot positions, and encodings such as size, shape, color</li>
<li>
<strong>Scale</strong> e.g normalizing values</li>
<li>
<strong>Geometric objects</strong> including points, lines, bars, … to represent data</li>
<li>
<strong>Statistics</strong>, including confidence intervals, means, quantiles, …</li>
<li>
<strong>Facets</strong>, i.e. subplots based on multiple dimensions</li>
<li>
<strong>Coordinate system</strong>, e.g cartesian, polar, …</li>
</ul>
<p>Until now you’ve probably thought of each plot type as it’s own distinctive format (a scatter plot, a pie chart, etc) and have not considered that each plot can be broken down into these fundamental components, so at first this way of thinking of plots will likely not seem intuitive.</p>
<p>But if you commit to thinking about plots in this abstract way you will quickly learn how these components fit together and realize the flexibility that thinking about plots in this way will give you to quickly generate exploratory plots, optimize your visualizations and be able to generate pretty much any plot you can think up<label for="tufte-sn-2" class="margin-toggle sidenote-number">2</label><input type="checkbox" id="tufte-sn-2" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">2</span> You will also see that keeping your data <code>tidy</code> will allow you to customize your plots using different aesthetics and mappings to group your data.</span>.</p>
</div>
<div id="building-plots" class="section level2">
<h2>
<span class="header-section-number">14.2</span> Building plots<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('building-plots')" onmouseout="reset_tooltip('building-plots-tooltip')"><span class="tooltiptext" id="building-plots-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Y’all ready for this?</p>
<p>Then, let’s go back to our global mean temperature anomaly data set to figure out how the grammar of graphics can be applied and plot some data!</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="visualization.html#cb2-1"></a>temperature &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">"data/GLB.Ts+dSST.csv"</span>, <span class="dt">delim =</span> <span class="st">","</span>, <span class="dt">skip =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb2-2"><a href="visualization.html#cb2-2"></a><span class="st">  </span><span class="kw">replace</span>(. <span class="op">==</span><span class="st"> "***"</span>, <span class="ot">NA</span>) <span class="op">%&gt;%</span></span>
<span id="cb2-3"><a href="visualization.html#cb2-3"></a><span class="st">  </span><span class="kw">mutate_if</span>(is.character, as.numeric)</span></code></pre></div>
<p>Recall how we created a line plot:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="visualization.html#cb3-1"></a><span class="kw">ggplot</span>(temperature, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">J-D</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb3-2"><a href="visualization.html#cb3-2"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>We can generalize this into a basic template that can be used for different kinds of plots, including scatter plots, bar plots, and box plots.</p>
<pre><code>
ggplot(data = &lt;DATA&gt;, mapping = aes(&lt;MAPPINGS&gt;)) +
  &lt;GEOM_FUNCTION&gt;
</code></pre>
<p>Essentiall, the minimum components needed to make a plot are</p>
<ol style="list-style-type: decimal">
<li>A data set (<code>&lt;DATA&gt;</code>), this will be a <code>data.frame</code> or a <code>tibble</code><label for="tufte-sn-3" class="margin-toggle sidenote-number">3</label><input type="checkbox" id="tufte-sn-3" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">3</span> Remember, when we use <code>read_delim()</code> our data is automatically a object of the format <code>tibble</code> and <code>data.frame</code>; a <code>tibble</code> has some additional properties but we can use them interchangeably</span>.</li>
<li>Based on the data, we need to define what variables we are going to plot (<code>&lt;MAPPINGS&gt;</code>) and how we want them to be represented, i.e. what individual data points should look like and how they are encoded.</li>
<li>We need to define the geometries, i.e. what type of plot (<code>&lt;GEOM_FUNCTION</code>).</li>
</ol>
<p>Let’s break down what is happening to get a better understanding of how these minimum components fit together to create individual plots.</p>
<p>First, we use the <code>ggplot()</code> function to define the specific <code>data.frame</code> to use to build the plot using the <code>data</code> argument (<code>&lt;DATA&gt;</code>)<label for="tufte-sn-4" class="margin-toggle sidenote-number">4</label><input type="checkbox" id="tufte-sn-4" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">4</span> Remember, that when we are using arguments in the specified sequence that they are defined you do not explicitly need to call them. We will specify <code>data =</code> and <code>mapping =</code> in our examples to understand what they represent but you will likely leave those out as you become more comfortable with <code>ggplot</code>.</span>.</p>
<p>In our example that would be</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="visualization.html#cb5-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> temperature)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>Not much happens when you execute that piece of code other than creating a blank canvas in your plot panel<label for="tufte-sn-5" class="margin-toggle sidenote-number">5</label><input type="checkbox" id="tufte-sn-5" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">5</span> If you are using and <code>Rmarkdown</code> document and have <code>Chunk Output Inline</code> enabled it will print beneath your code chunk</span>.</p>
<p>That is because we still need to define an aesthetic mapping using the <code>aes()</code> function (<code>&lt;MAPPING&gt;</code>).</p>
<p>Here, we are selecting the variables that we want to plot (columns in our <code>data.frame</code>). At minimum we need to specify what columns we want to plot on the x and y axis, but we can also define variables (columns) we want to use to encode using color, shapes, size etc.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="visualization.html#cb6-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> temperature, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">J-D</span><span class="st">`</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>When we execute that code you will now get an empty coordinate system.</p>
<p>Patience, young grasshopper, we have not yet defined the <code>geom</code>, i.e. what type of plot (“geometries”, <code>&lt;GEOM_FUNCTION&gt;</code>) we want to use. For example, here we want generate a line plot (<code>geom_line()</code>).</p>
<p>For <code>ggplot</code> we add layers using the <code>+</code> operator, which is a pipe (similar to <code>%&gt;%</code>) which tells <code>R</code> “and now add this”.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="visualization.html#cb7-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> temperature, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">J-D</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb7-2"><a href="visualization.html#cb7-2"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>Now, we’re playing!</p>
<p>One of the advantages of the layered framework of <code>ggplot2</code> is that we can plot multiple layers in the same plot by adding additional <code>geoms</code>.</p>
<p>For example, we can plot a scatterplot and line plot in the same plot as such:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="visualization.html#cb8-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> temperature, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">J-D</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb8-2"><a href="visualization.html#cb8-2"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb8-3"><a href="visualization.html#cb8-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>Now that you know how to generate a simple plot, let’s think about how we can further modify it to improve your visualization.</p>
<p>For example we can change the color, fill, size, and shape for each <code>geom</code> layer<label for="tufte-sn-6" class="margin-toggle sidenote-number">6</label><input type="checkbox" id="tufte-sn-6" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">6</span> In this example we will use the arguments for individual geom functions to change how data points are represented using colors and shapes for each layer, we can also use <code>aes()</code> to set mapping aesthetics for the entire plots.</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="visualization.html#cb9-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> temperature, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">J-D</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb9-2"><a href="visualization.html#cb9-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">"darkblue"</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb9-3"><a href="visualization.html#cb9-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">color =</span> <span class="st">"darkblue"</span>, <span class="dt">fill =</span> <span class="st">"white"</span>, <span class="dt">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>Shapes for points can be specified using numbers; note how some shapes are “solid”, i.e. specifying <code>color</code> will define the color of the shape. Others, like the one used in our example are filled, i.e. <code>color</code> will determine the color of the outline, and <code>fill</code> the color of the space inside. For “hollow” shapes (or e.g. X’s) <code>color</code> will determine the line color.</p>
<div class="figure">
<img src="figures/points-symbols.png" alt=""><p class="caption">Numeric codes for sympols.</p>
</div>
<p>You can specify colors either using the <a href="http://applied-r.com/r-color-tables/">color names</a> defined by R or using hex codes.</p>
<p><label for="tufte-mn-1" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-1" class="margin-toggle"><span class="marginnote"><span style="display: block;">Some exploring will also lead you to various color pallets, Wes Anderson fan? You can <a href="https://github.com/karthik/wesanderson">style your plots</a> accordingly… dig the aesthetics of the old school National Park posters and images? <a href="https://github.com/katiejolly/nationalparkcolors">R community got you covered.</a>.</span></span></p>
<p>Previously, we also used <code>geom_smooth()</code> to add a layer with a linear regression. If you take a look at the arguments for this function using <code>?geom_smooth</code> you will see that this has additional arguments apart from the mapping aesthetics like choosing the type of regression, whether or not the confidence interval is shown etc. Let’s say we want to add a red, dashed regression line without the confidence interval.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="visualization.html#cb10-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> temperature, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">J-D</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb10-2"><a href="visualization.html#cb10-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">"darkblue"</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb10-3"><a href="visualization.html#cb10-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">color =</span> <span class="st">"darkblue"</span>, <span class="dt">fill =</span> <span class="st">"white"</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb10-4"><a href="visualization.html#cb10-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">stat =</span> <span class="st">"smooth"</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">"red"</span>, <span class="dt">linetype =</span> <span class="st">"dashed"</span>, <span class="dt">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>Admittedly, this plot is starting to look a little bit ridiculous. Maybe we should think of alternative options for visualizing this data to explore some additional <code>ggplot</code> options.</p>
<p>Another way to visualize this data would be using a bar plot<label for="tufte-sn-7" class="margin-toggle sidenote-number">7</label><input type="checkbox" id="tufte-sn-7" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">7</span> Can we appreciate for a second how easy it was to change how the same data is plotted? If you were using excel you would have had to insert a new plot, define what data you wanted to plot, relabel the axis, etc. Here all you had to do was change a single line of code</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="visualization.html#cb11-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> temperature, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">J-D</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb11-2"><a href="visualization.html#cb11-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>Notice, how this is still the exact same mapping aesthetics (time/year on the x-axis and the temperature anomaly on the y-axis) but it changes the way we see the data completely - the emphasis now is on the change of temperatures below the long-term mean and the change to those temperature differences to being positive.</p>
<p>Let’s say we want really lean into demonstrating this drastic change in temperatures not only being above the long-term average but also steadily increasing. One way to do this is to use color. We could modify this bar plot to have all of our bars representing years with global mean temperatures below the 1951-1980 average in one color and those above in another.</p>
<p>To do this, we need a column that encodes that information… that of course is not an issue for us a basically professional data wranglers! We can use a simple conditional mutate using an <code>ifelse()</code> statement to add a column (<code>year_type</code>) that indicates whether temperatures are above or below the the long-term average.</p>
<p>We can manipulate our <code>data.frame</code> using the <code>dplyr</code> functions we are already familiar with - we can then use the <code>%&gt;%</code> pipe to pass the data argument to the <code>ggplot()</code> function<label for="tufte-sn-8" class="margin-toggle sidenote-number">8</label><input type="checkbox" id="tufte-sn-8" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">8</span> When you do this, remember that you need to switch back to using the <code>+</code> operator once you are adding your geom layers.</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="visualization.html#cb12-1"></a>temperature <span class="op">%&gt;%</span></span>
<span id="cb12-2"><a href="visualization.html#cb12-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year_type =</span> <span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">J-D</span><span class="st">`</span> <span class="op">&lt;=</span><span class="dv">0</span>, <span class="st">"colder"</span>, <span class="st">"hotter"</span>)) <span class="op">%&gt;%</span></span>
<span id="cb12-3"><a href="visualization.html#cb12-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">J-D</span><span class="st">`</span>, <span class="dt">fill =</span> year_type, <span class="dt">color =</span> year_type)) <span class="op">+</span></span>
<span id="cb12-4"><a href="visualization.html#cb12-4"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>Anything that we add to the <code>ggplot()</code> layer as a mapping is a universal plot setting that will apply to all subsequent layers. You can override these global settings is you specify aesthetics like color, shape or size specifically in an separate layer. For example if we do the following, we will override our color coding even though we specified it in our <code>ggplot()</code> layer.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="visualization.html#cb13-1"></a>temperature <span class="op">%&gt;%</span></span>
<span id="cb13-2"><a href="visualization.html#cb13-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year_type =</span> <span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">J-D</span><span class="st">`</span> <span class="op">&lt;=</span><span class="dv">0</span>, <span class="st">"colder"</span>, <span class="st">"hotter"</span>)) <span class="op">%&gt;%</span></span>
<span id="cb13-3"><a href="visualization.html#cb13-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">J-D</span><span class="st">`</span>, <span class="dt">fill =</span> year_type, <span class="dt">color =</span> year_type)) <span class="op">+</span></span>
<span id="cb13-4"><a href="visualization.html#cb13-4"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>, <span class="dt">color =</span> <span class="st">"blue"</span>, <span class="dt">fill =</span> <span class="st">"blue"</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<p>Let’s see what else we can visualize using <code>ggplot</code>. Recall from when you explored our temperature anomaly data set, that this data set also contains information for seasons and individual months.</p>
<p>Let’s take a look at the distribution of mean global winter temperatures (<code>DJF</code> = December, January, February) using a histogram, (<code>geom_histogram()</code>)<label for="tufte-sn-9" class="margin-toggle sidenote-number">9</label><input type="checkbox" id="tufte-sn-9" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">9</span> Notice that we only need to define our x-axis to plot a histogram, this is because <code>ggplot2</code> will count how many observations fall into each bin for you … this geom is a mixture of a geometry (bar plot) and a statistical transformation (binning data points into ranges and the plotting those as bar plots).</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="visualization.html#cb14-1"></a><span class="kw">ggplot</span>(temperature, <span class="kw">aes</span>(<span class="dt">x =</span> DJF)) <span class="op">+</span></span>
<span id="cb14-2"><a href="visualization.html#cb14-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<p>We can refine our plot by choosing our own binwidth and by manipulating fill and color.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="visualization.html#cb15-1"></a><span class="kw">ggplot</span>(temperature, <span class="kw">aes</span>(<span class="dt">x =</span> SON)) <span class="op">+</span></span>
<span id="cb15-2"><a href="visualization.html#cb15-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>, <span class="dt">color =</span> <span class="st">"black"</span>, <span class="dt">fill =</span> <span class="st">"darkorange"</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<p>For our example we might also want to add a vertical line (<code>geom_vline()</code>) to indicate 0 (i.e. the long-term global temperature mean calculated for 1951 - 1980).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="visualization.html#cb16-1"></a><span class="kw">ggplot</span>(temperature, <span class="kw">aes</span>(<span class="dt">x =</span> SON)) <span class="op">+</span></span>
<span id="cb16-2"><a href="visualization.html#cb16-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>, <span class="dt">color =</span> <span class="st">"black"</span>, <span class="dt">fill =</span> <span class="st">"darkorange"</span>) <span class="op">+</span></span>
<span id="cb16-3"><a href="visualization.html#cb16-3"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">"darkred"</span>, <span class="dt">linetype =</span> <span class="st">"dashed"</span>, <span class="dt">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<p>If we want to compare multiple distributions, box plots can be more helpful than histograms. Let’s say we wanted to compare the distribution of mean global temperature for each season.</p>
<p>How can we go about this?</p>
<p>Currently, our seasons are in individual columns, so our first step would be to create a tidy data set.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="visualization.html#cb17-1"></a>tidy_season &lt;-<span class="st"> </span>temperature <span class="op">%&gt;%</span></span>
<span id="cb17-2"><a href="visualization.html#cb17-2"></a><span class="st">  </span><span class="kw">select</span>(Year, DJF, MAM, JJA, SON) <span class="op">%&gt;%</span></span>
<span id="cb17-3"><a href="visualization.html#cb17-3"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">names_to =</span> <span class="st">"season"</span>, <span class="dt">values_to =</span> <span class="st">"temperature"</span>, <span class="dv">2</span><span class="op">:</span><span class="dv">5</span>)</span></code></pre></div>
<p>Now we can plot our seasons on the x-axis and the distribution of temperatures on the y-axis using <code>geom_boxplot()</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="visualization.html#cb18-1"></a><span class="kw">ggplot</span>(tidy_season, <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> temperature)) <span class="op">+</span></span>
<span id="cb18-2"><a href="visualization.html#cb18-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<p>Again, you can add additional information using the mapping aesthetics to e.g. color code the boxes by season.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="visualization.html#cb19-1"></a><span class="kw">ggplot</span>(tidy_season, <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> temperature, <span class="dt">fill =</span> season)) <span class="op">+</span></span>
<span id="cb19-2"><a href="visualization.html#cb19-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
</div>
<div id="faceting-plots" class="section level2">
<h2>
<span class="header-section-number">14.3</span> Faceting plots<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('faceting-plots')" onmouseout="reset_tooltip('faceting-plots-tooltip')"><span class="tooltiptext" id="faceting-plots-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>One of the advantages of <code>ggplot2</code> being based not only on the grammar of graphics but being designed to play extremely well with tidy data sets is being able to create faceted plots. A faceted plot involves splitting a single plot into a matrix of panels, where each panel shows a different subset of the data. This is especially helpful during exploratory analysis where you might first plot all your data points in a single graph but then want to look at whether or not individual subsets within the data set behave the same.</p>
<p>Let’s look at an example to better understand what faceting plots looks like. For example, let’s say we wanted to create individual plots of our bar plots showing our deviations of global temperatures from the 1951 - 1980 mean for each season.</p>
<p>How could you create individual plots with the methods you are already familiar with?</p>
<p>Here is how you can do it using <code>facet_grid()</code>.</p>
<p>Now we can plot our data and using <code>facet_grid()</code> we can specify that we want individual panels by month in separate rows.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="visualization.html#cb20-1"></a><span class="kw">ggplot</span>(tidy_season, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> temperature)) <span class="op">+</span></span>
<span id="cb20-2"><a href="visualization.html#cb20-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>, <span class="dt">fill =</span> <span class="st">"darkorange"</span>, <span class="dt">color =</span> <span class="st">"darkorange"</span>) <span class="op">+</span></span>
<span id="cb20-3"><a href="visualization.html#cb20-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(<span class="dt">rows =</span> <span class="kw">vars</span>(season))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<p>You could also specify that you want the individual plots to be separated into columns.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="visualization.html#cb21-1"></a><span class="kw">ggplot</span>(tidy_season, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> temperature)) <span class="op">+</span></span>
<span id="cb21-2"><a href="visualization.html#cb21-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>, <span class="dt">fill =</span> <span class="st">"darkorange"</span>, <span class="dt">color =</span> <span class="st">"darkorange"</span>) <span class="op">+</span></span>
<span id="cb21-3"><a href="visualization.html#cb21-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(<span class="dt">cols =</span> <span class="kw">vars</span>(season))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<p>You can also create faceted plot where subset your data by two variables and so you end up with one variable defining the rows and one the columns and you can use a simpler syntax <code>row-variable ~ column-variable</code>.</p>
<p>You can also use this syntax if you are only faceting by one variable as we are doing in this example by specifying the variable and leaving the other one “blank” using a <code>.</code>.</p>
<p>For example, to plot this faceted data set in rows, you would use the following syntax -</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="visualization.html#cb22-1"></a><span class="kw">ggplot</span>(tidy_season, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> temperature)) <span class="op">+</span></span>
<span id="cb22-2"><a href="visualization.html#cb22-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>, <span class="dt">fill =</span> <span class="st">"darkorange"</span>, <span class="dt">color =</span> <span class="st">"darkorange"</span>) <span class="op">+</span></span>
<span id="cb22-3"><a href="visualization.html#cb22-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(season <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
<p>And to plot this data set column-wise you would specify it like so -</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="visualization.html#cb23-1"></a><span class="kw">ggplot</span>(tidy_season, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> temperature)) <span class="op">+</span></span>
<span id="cb23-2"><a href="visualization.html#cb23-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>, <span class="dt">fill =</span> <span class="st">"darkorange"</span>, <span class="dt">color =</span> <span class="st">"darkorange"</span>) <span class="op">+</span></span>
<span id="cb23-3"><a href="visualization.html#cb23-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>season)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
</div>
<div id="customizing-plots" class="section level2">
<h2>
<span class="header-section-number">14.4</span> Customizing plots<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('customizing-plots')" onmouseout="reset_tooltip('customizing-plots-tooltip')"><span class="tooltiptext" id="customizing-plots-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>We have already played around a little bit with the options that we have in terms of customizing plots using color, fill, shapes, and sizes. But we’ve barely scratched the surface.</p>
<p>You have probably noticed that there are some default settings like the gray background and white grid lines, font sizes of label axis, what the axis labels are, and even color schemes that are automatically used. Even using the defaults we get pretty clean plots that are visually appealing. This is super helpful during exploratory analysis because even though you playing around with the data you still have nicely formatted and easy to interpret figures.</p>
<p>Once you have identified the central plots that you want to use to communicate the results and conclusions of your data analysis you will want to further customize your visualization to optimize communication, this includes how you encode data using color and shape but also making sure that everything is well labeled and clear to the person who is reading your report or listening to your presentation.</p>
<p>One of the first things we frequently want to changes is the axis labels. <code>ggplot2</code> does handily use the column names to automatically label your axes, so you will always have a label which is great during exploratory analysis but generally you will want to customize that for your final figure. The function <code>labs()</code> can be used to specify a title, subtitle, axis labels and additional annotations (caption) below the figure.</p>
<p>For example we could customize our faceted figure to look like this:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="visualization.html#cb24-1"></a><span class="kw">ggplot</span>(tidy_season, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> temperature)) <span class="op">+</span></span>
<span id="cb24-2"><a href="visualization.html#cb24-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>, <span class="dt">fill =</span> <span class="st">"darkorange"</span>, <span class="dt">color =</span> <span class="st">"darkorange"</span>) <span class="op">+</span></span>
<span id="cb24-3"><a href="visualization.html#cb24-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(<span class="dt">rows =</span> <span class="kw">vars</span>(season)) <span class="op">+</span></span>
<span id="cb24-4"><a href="visualization.html#cb24-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Change in global seasonal temperatures 1880 - 2020"</span>,</span>
<span id="cb24-5"><a href="visualization.html#cb24-5"></a>       <span class="dt">subtitle =</span> <span class="st">"Global mean temperatures relative to 1951 - 1980 mean"</span>,</span>
<span id="cb24-6"><a href="visualization.html#cb24-6"></a>       <span class="dt">x =</span> <span class="st">"Year"</span>, <span class="dt">y =</span> <span class="st">"Temperature [C]"</span>,</span>
<span id="cb24-7"><a href="visualization.html#cb24-7"></a>       <span class="dt">caption =</span> <span class="st">"Date source: NASA Goddard Institute for Space Studies"</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672"></p>
<p>Pretty much every component of a <code>ggplot</code> figure can be further customized using <code>theme()</code>, this includes things like font size, background and line colors, grids, legend position … <code>ggplot2</code> odes have some pre-defined themes that you can call up that will change the layout.</p>
<p>The default theme is <code>theme_grey()</code>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="visualization.html#cb25-1"></a><span class="kw">ggplot</span>(tidy_season, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> temperature)) <span class="op">+</span></span>
<span id="cb25-2"><a href="visualization.html#cb25-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>, <span class="dt">fill =</span> <span class="st">"darkorange"</span>, <span class="dt">color =</span> <span class="st">"darkorange"</span>) <span class="op">+</span></span>
<span id="cb25-3"><a href="visualization.html#cb25-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(<span class="dt">rows =</span> <span class="kw">vars</span>(season)) <span class="op">+</span></span>
<span id="cb25-4"><a href="visualization.html#cb25-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Change in global seasonal temperatures 1880 - 2020"</span>,</span>
<span id="cb25-5"><a href="visualization.html#cb25-5"></a>       <span class="dt">subtitle =</span> <span class="st">"Global mean temperatures relative to 1951 - 1980 mean"</span>,</span>
<span id="cb25-6"><a href="visualization.html#cb25-6"></a>       <span class="dt">x =</span> <span class="st">"Year"</span>, <span class="dt">y =</span> <span class="st">"Temperature [C]"</span>,</span>
<span id="cb25-7"><a href="visualization.html#cb25-7"></a>       <span class="dt">caption =</span> <span class="st">"Date source: NASA Goddard Institute for Space Studies"</span>) <span class="op">+</span></span>
<span id="cb25-8"><a href="visualization.html#cb25-8"></a><span class="st">  </span><span class="kw">theme_grey</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="672"></p>
<p>Here, we explicitly specified it using <code>theme_grey()</code>; if you do not specify a theme this is the theme that will be used for your plot. There are other themes that are part of the <code>ggplot</code> package that include <code>theme_bw()</code>, <code>theme_minimal()</code>, <code>theme_classic()</code> or <code>theme_light()</code>.</p>
<p>Try one!</p>
<p>You will likely find a theme that you like but still want to make additional tweaks in that case <code>theme()</code> is your friend.</p>
<p>Let’s go back to our bar plot of the global temperature anomaly to look at an example of likely the three most common things you will want to adjust which is the legend position, changing font size, color, turning x-axis labels by 90 degrees.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="visualization.html#cb26-1"></a>temperature <span class="op">%&gt;%</span></span>
<span id="cb26-2"><a href="visualization.html#cb26-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year_type =</span> <span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">J-D</span><span class="st">`</span> <span class="op">&lt;=</span><span class="dv">0</span>, <span class="st">"colder"</span>, <span class="st">"hotter"</span>)) <span class="op">%&gt;%</span></span>
<span id="cb26-3"><a href="visualization.html#cb26-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">J-D</span><span class="st">`</span>, <span class="dt">fill =</span> year_type, <span class="dt">color =</span> year_type)) <span class="op">+</span></span>
<span id="cb26-4"><a href="visualization.html#cb26-4"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>) <span class="op">+</span></span>
<span id="cb26-5"><a href="visualization.html#cb26-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Change in global mean temperatures 1880 - 2020"</span>,</span>
<span id="cb26-6"><a href="visualization.html#cb26-6"></a>       <span class="dt">subtitle =</span> <span class="st">"Global mean temperatures relative to 1951 - 1980 mean"</span>,</span>
<span id="cb26-7"><a href="visualization.html#cb26-7"></a>       <span class="dt">x =</span> <span class="st">"Year"</span>, <span class="dt">y =</span> <span class="st">"Temperature [C]"</span>,</span>
<span id="cb26-8"><a href="visualization.html#cb26-8"></a>       <span class="dt">caption =</span> <span class="st">"Date source: NASA Goddard Institute for Space Studies"</span>) <span class="op">+</span></span>
<span id="cb26-9"><a href="visualization.html#cb26-9"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb26-10"><a href="visualization.html#cb26-10"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb26-11"><a href="visualization.html#cb26-11"></a>        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">"black"</span>,</span>
<span id="cb26-12"><a href="visualization.html#cb26-12"></a>                                   <span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb26-13"><a href="visualization.html#cb26-13"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">"black"</span>,),</span>
<span id="cb26-14"><a href="visualization.html#cb26-14"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="672"></p>
<p>That’s starting to look pretty slick.</p>
<p>As you start your visualization adventure the <a href="https://www.cookbook-r.com/Graphs/Colors_(ggplot2)/">R Cookbook</a> is a good resource. It is written in a helpful style that starts with a concrete plotting problem and then walks you through a solution.</p>
</div>
<div id="arranging-plots" class="section level2">
<h2>
<span class="header-section-number">14.5</span> Arranging plots<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('arranging-plots')" onmouseout="reset_tooltip('arranging-plots-tooltip')"><span class="tooltiptext" id="arranging-plots-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>We’ve already seen that we can create multi-panel plots in a very straightforward way when we are essentially plotting the same plot for different subsets of the data.</p>
<p>But what if we want to generate individual plots that might fit together thematically but aren’t subsets that we can facet but we still want to be able to present them together? Fear not, this too can be solved; one option is using <code>patchwork</code>, a package designed for exactly this purpose. Let’s generate a few additional plots so we can try this out.</p>
<p>In our data folder there is a tab-delimited file with monthly mean CO2 concentrations (parts per million) from Maunua Loa. Let’s read in that data set and create line plot with a regression line.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="visualization.html#cb27-1"></a>carbon &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">"data/CO2_monthly.txt"</span>, <span class="dt">delim =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb27-2"><a href="visualization.html#cb27-2"></a></span>
<span id="cb27-3"><a href="visualization.html#cb27-3"></a><span class="kw">ggplot</span>(carbon, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> average)) <span class="op">+</span></span>
<span id="cb27-4"><a href="visualization.html#cb27-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">"blue"</span>) <span class="op">+</span></span>
<span id="cb27-5"><a href="visualization.html#cb27-5"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span></span>
<span id="cb27-6"><a href="visualization.html#cb27-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Atmospheric CO2"</span>,</span>
<span id="cb27-7"><a href="visualization.html#cb27-7"></a>       <span class="dt">subtitle =</span> <span class="st">"monthly mean CO2 Mauna Loa CO2"</span>,</span>
<span id="cb27-8"><a href="visualization.html#cb27-8"></a>       <span class="dt">x =</span> <span class="st">"year"</span>, <span class="dt">y =</span> <span class="st">"CO2 concentration air [ppm]"</span>,</span>
<span id="cb27-9"><a href="visualization.html#cb27-9"></a>       <span class="dt">caption =</span> <span class="st">"Data: NOAA/ESRL"</span>) <span class="op">+</span></span>
<span id="cb27-10"><a href="visualization.html#cb27-10"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-28-1.png" width="672"></p>
<p>We also have a data set from the Global Carbon Project downloaded from the <a href="https://github.com/owid/co2-data">Our World in Data repository</a> that contains atmospheric CO2 emissions. We can plot that as a simple line plot with a regression.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="visualization.html#cb28-1"></a>emissions &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">"data/emissions.txt"</span>, <span class="dt">delim =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>) <span class="op">%&gt;%</span></span>
<span id="cb28-2"><a href="visualization.html#cb28-2"></a><span class="st">  </span><span class="kw">filter</span>(iso_code <span class="op">==</span><span class="st"> "OWID_WRL"</span>)</span>
<span id="cb28-3"><a href="visualization.html#cb28-3"></a></span>
<span id="cb28-4"><a href="visualization.html#cb28-4"></a><span class="kw">ggplot</span>(emissions, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> co2)) <span class="op">+</span></span>
<span id="cb28-5"><a href="visualization.html#cb28-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">"blue"</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb28-6"><a href="visualization.html#cb28-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span></span>
<span id="cb28-7"><a href="visualization.html#cb28-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"CO2 Emissions over time."</span>,</span>
<span id="cb28-8"><a href="visualization.html#cb28-8"></a>       <span class="dt">subtitle =</span> <span class="st">"Global emissions atmospheric emissions by year."</span>,</span>
<span id="cb28-9"><a href="visualization.html#cb28-9"></a>       <span class="dt">x =</span> <span class="st">"year"</span>, <span class="dt">y =</span> <span class="st">"CO2 [Gt/year]"</span>,</span>
<span id="cb28-10"><a href="visualization.html#cb28-10"></a>       <span class="dt">caption =</span> <span class="st">"Data: Global Carbon Project/Our World in Data"</span>) <span class="op">+</span></span>
<span id="cb28-11"><a href="visualization.html#cb28-11"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-29-1.png" width="672"></p>
<p>To be able to plot multiple plots in one using <code>patchwork</code> we need to assign our figures as objects.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="visualization.html#cb29-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(carbon, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> average)) <span class="op">+</span></span>
<span id="cb29-2"><a href="visualization.html#cb29-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">"blue"</span>) <span class="op">+</span></span>
<span id="cb29-3"><a href="visualization.html#cb29-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span></span>
<span id="cb29-4"><a href="visualization.html#cb29-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Atmospheric CO2"</span>,</span>
<span id="cb29-5"><a href="visualization.html#cb29-5"></a>       <span class="dt">subtitle =</span> <span class="st">"monthly mean CO2 Mauna Loa CO2"</span>,</span>
<span id="cb29-6"><a href="visualization.html#cb29-6"></a>       <span class="dt">x =</span> <span class="st">"year"</span>, <span class="dt">y =</span> <span class="st">"CO2 concentration air [ppm]"</span>,</span>
<span id="cb29-7"><a href="visualization.html#cb29-7"></a>       <span class="dt">caption =</span> <span class="st">"Data: NOAA/ESRL"</span>) <span class="op">+</span></span>
<span id="cb29-8"><a href="visualization.html#cb29-8"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span>
<span id="cb29-9"><a href="visualization.html#cb29-9"></a></span>
<span id="cb29-10"><a href="visualization.html#cb29-10"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(emissions, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> co2)) <span class="op">+</span></span>
<span id="cb29-11"><a href="visualization.html#cb29-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">"blue"</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb29-12"><a href="visualization.html#cb29-12"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span></span>
<span id="cb29-13"><a href="visualization.html#cb29-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Atmospheric CO2 Emissions"</span>,</span>
<span id="cb29-14"><a href="visualization.html#cb29-14"></a>       <span class="dt">subtitle =</span> <span class="st">"global emissions"</span>,</span>
<span id="cb29-15"><a href="visualization.html#cb29-15"></a>       <span class="dt">x =</span> <span class="st">"year"</span>, <span class="dt">y =</span> <span class="st">"CO2 [Gt/year]"</span>,</span>
<span id="cb29-16"><a href="visualization.html#cb29-16"></a>       <span class="dt">caption =</span> <span class="st">"Data: Global Carbon Project/Our World in Data"</span>) <span class="op">+</span></span>
<span id="cb29-17"><a href="visualization.html#cb29-17"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p>Now we can combine them side by side using a simple syntax.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="visualization.html#cb30-1"></a>p1 <span class="op">+</span><span class="st"> </span>p2</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="672"></p>
<p>Similarly, we can plot them underneath each other like so -</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="visualization.html#cb31-1"></a>p1 <span class="op">/</span><span class="st"> </span>p2</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-32-1.png" width="672"></p>
<p>Oh, it gets better. Let’s say we wanted to plot our global mean temperatures in the top row and our two emissions plots below.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="visualization.html#cb32-1"></a>p3 &lt;-<span class="st"> </span>temperature <span class="op">%&gt;%</span></span>
<span id="cb32-2"><a href="visualization.html#cb32-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year_type =</span> <span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">J-D</span><span class="st">`</span> <span class="op">&lt;=</span><span class="dv">0</span>, <span class="st">"colder"</span>, <span class="st">"hotter"</span>)) <span class="op">%&gt;%</span></span>
<span id="cb32-3"><a href="visualization.html#cb32-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">J-D</span><span class="st">`</span>, <span class="dt">fill =</span> year_type, <span class="dt">color =</span> year_type)) <span class="op">+</span></span>
<span id="cb32-4"><a href="visualization.html#cb32-4"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>) <span class="op">+</span></span>
<span id="cb32-5"><a href="visualization.html#cb32-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Change in global mean temperatures 1880 - 2020"</span>,</span>
<span id="cb32-6"><a href="visualization.html#cb32-6"></a>       <span class="dt">subtitle =</span> <span class="st">"Global mean temperatures relative to 1951 - 1980 mean"</span>,</span>
<span id="cb32-7"><a href="visualization.html#cb32-7"></a>       <span class="dt">x =</span> <span class="st">"Year"</span>, <span class="dt">y =</span> <span class="st">"Temperature [C]"</span>,</span>
<span id="cb32-8"><a href="visualization.html#cb32-8"></a>       <span class="dt">caption =</span> <span class="st">"Date source: NASA Goddard Institute for Space Studies"</span>) <span class="op">+</span></span>
<span id="cb32-9"><a href="visualization.html#cb32-9"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb32-10"><a href="visualization.html#cb32-10"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb32-11"><a href="visualization.html#cb32-11"></a>        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">"black"</span>,</span>
<span id="cb32-12"><a href="visualization.html#cb32-12"></a>                                   <span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb32-13"><a href="visualization.html#cb32-13"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">"black"</span>,),</span>
<span id="cb32-14"><a href="visualization.html#cb32-14"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>))</span>
<span id="cb32-15"><a href="visualization.html#cb32-15"></a></span>
<span id="cb32-16"><a href="visualization.html#cb32-16"></a>p3 <span class="op">/</span><span class="st"> </span>(p1 <span class="op">|</span><span class="st"> </span>p2)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672"></p>
<p>You can create complex compositions in <code>patchwork</code> using syntax combining <code>+</code>, <code>|</code>, and <code>\</code>. To see how you can control the layout even further you can check out the <a href="https://patchwork.data-imaginist.com/articles/guides/layout.html">documentation for patchwork</a>.</p>
</div>
<div id="exporting-plots" class="section level2">
<h2>
<span class="header-section-number">14.6</span> Exporting Plots<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('exporting-plots')" onmouseout="reset_tooltip('exporting-plots-tooltip')"><span class="tooltiptext" id="exporting-plots-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>The last thing we still have to figure out is how to save plots. You have a few options.</p>
<p>The quickest and dirtiest option is to simply right click on the plot pane after plotting a figure and then save the figure using <code>Save image as</code>. This works and is easy to do but gives you very little control over the dimensions, resolution, file format etc.</p>
<p>For more control over the format of your figure you can use the Export tab in the Plot pane which will allow you to adjust the dimensions and the the file format.</p>
<p>Finally, the <code>ggplot2</code> has a function called <code>ggsave()</code> that will allow you to determine the dimensions (<code>width</code>, <code>height</code>), resolution (<code>dpi</code>), and format (<code>device</code>).</p>
<p>By default it will save the last plot that was plotted. If you specify the format in the file name (e.g. <code>*.svg</code>, <code>*.jpg</code>, <code>*.png</code>) it will automatically recognize the format<label for="tufte-sn-10" class="margin-toggle sidenote-number">10</label><input type="checkbox" id="tufte-sn-10" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">10</span> Remember that we have designed our research compendium to keep raw and processed data, and results separate? Figures are considered results so you should always save them to the <code>results</code> folder.</span>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="visualization.html#cb33-1"></a>temperature <span class="op">%&gt;%</span></span>
<span id="cb33-2"><a href="visualization.html#cb33-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year_type =</span> <span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">J-D</span><span class="st">`</span> <span class="op">&lt;=</span><span class="dv">0</span>, <span class="st">"colder"</span>, <span class="st">"hotter"</span>)) <span class="op">%&gt;%</span></span>
<span id="cb33-3"><a href="visualization.html#cb33-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">J-D</span><span class="st">`</span>, <span class="dt">fill =</span> year_type, <span class="dt">color =</span> year_type)) <span class="op">+</span></span>
<span id="cb33-4"><a href="visualization.html#cb33-4"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>) <span class="op">+</span></span>
<span id="cb33-5"><a href="visualization.html#cb33-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Change in global mean temperatures 1880 - 2020"</span>,</span>
<span id="cb33-6"><a href="visualization.html#cb33-6"></a>       <span class="dt">subtitle =</span> <span class="st">"Global mean temperatures relative to 1951 - 1980 mean"</span>,</span>
<span id="cb33-7"><a href="visualization.html#cb33-7"></a>       <span class="dt">x =</span> <span class="st">"Year"</span>, <span class="dt">y =</span> <span class="st">"Temperature [C]"</span>,</span>
<span id="cb33-8"><a href="visualization.html#cb33-8"></a>       <span class="dt">caption =</span> <span class="st">"Date source: NASA Goddard Institute for Space Studies"</span>) <span class="op">+</span></span>
<span id="cb33-9"><a href="visualization.html#cb33-9"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb33-10"><a href="visualization.html#cb33-10"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb33-11"><a href="visualization.html#cb33-11"></a>        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">"black"</span>,</span>
<span id="cb33-12"><a href="visualization.html#cb33-12"></a>                                   <span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb33-13"><a href="visualization.html#cb33-13"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">"black"</span>,),</span>
<span id="cb33-14"><a href="visualization.html#cb33-14"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-1.png" width="672"></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="visualization.html#cb34-1"></a><span class="kw">ggsave</span>(<span class="st">"results/global_temp.png"</span>, <span class="dt">dpi =</span> <span class="dv">300</span>, <span class="dt">width =</span> <span class="dv">15</span>, <span class="dt">height =</span> <span class="dv">10</span>)</span></code></pre></div>
<p>Check your results folder to see if you were successful!</p>
<p>If you assign your plot to an object you can use the <code>plot</code> argument of the <code>ggsave()</code> function to export it. This also works for figures that consist of multiple panels combined using <code>patchwork</code>.</p>
</div>
<div id="more-plots" class="section level2">
<h2>
<span class="header-section-number">14.7</span> More Plots!<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('more-plots')" onmouseout="reset_tooltip('more-plots-tooltip')"><span class="tooltiptext" id="more-plots-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Ready to take the training wheels off?</p>
<p>Increasing global temperatures are effecting change across the different components of the climate system. There are several data sets in your <code>data</code> folder. Read in each data set as a data frame, use <code>View()</code> to take a look at what information is contained in the data set and the use your new found visualization skills to plot the data using <code>ggplot</code>.</p>
<div id="ques:Vis-" class="question">
<p class="question-begin">
► Question 1
</p>
<div class="question-body">
<p>Increasing atmospheric temperatures result in land ice melting and the ocean heat content rising. The latter leads to thermal expansion which together with the increase freshwater inflow results in rising sea levels.</p>
<p>The first data set is from the NOAA Laboratory for Satellite Altimetry and contains records from coastal sea level tide gauges. Start by reading in the data set</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="visualization.html#cb35-1"></a>sealevel &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">"data/sealevel.txt"</span>, <span class="dt">delim =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span></code></pre></div>
<p>Take a quick look at the data set using <code>Vew()</code> and briefly summarize what data is contained in this data set<label for="tufte-sn-11" class="margin-toggle sidenote-number">11</label><input type="checkbox" id="tufte-sn-11" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">11</span> Include things like the number of columns, what data is contained in each sample, what time periods are included etc. Practice deducing these types of things from the context of the data set description above and by browsing the content.</span></p>
<p>Plot the change in means sea level over time as a line plot and color code the line(s) by method. Chose a theme and position your legend below the figure. Bonus: Figure out how to use <code>geom_hline()</code> to add a line at 0.</p>
<p>Comment each line of your ggplot code (you can add comments between the lines or at the end), remember to caption your figure, list your data source and and label your axis in a meaningful way.</p>
<p>Write a short description of your figure summarizing the key results displayed.</p>
<p>Here’s an example of what that could look like.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="672"></p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:Vis-" class="question">
<p class="question-begin">
► Question 1
</p>
<div class="question-body">
<p>Our next data set is from the <a href="https://nsidc.org/data/seaice_index/archives">National Snow and Ice Data Center</a> and contains the Arcitc (Northern Hemisphere) July sea ice extent.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="visualization.html#cb36-1"></a>ice_arctic &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">"data/arctic_ice.txt"</span>, <span class="dt">delim =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span></code></pre></div>
<p>Take a quick look at the data set using <code>Vew()</code> and briefly summarize what data is contained in this data set. Be specific.</p>
<p>Plot the change in ice extent over time as a line plot. Chose a theme. Add a linear regression and confidence interval. Bonus: Change the default colors of the regression line and the confidence interval.</p>
<p>Comment each line of your ggplot code (you can add comments between the lines or at the end), remember to caption your figure, list your data source and and label your axis in a meaningful way.</p>
<p>Write a short description of your figure summarizing the key results displayed.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:Vis-" class="question">
<p class="question-begin">
► Question 1
</p>
<div class="question-body">
<p>Let’s take a look at the equivalent data set depicting sea ice extent in the Antarctic (Southern Hemisphere.)</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="visualization.html#cb37-1"></a>ice_arctic &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">"data/antarctic_ice.txt"</span>, <span class="dt">delim =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span></code></pre></div>
<p>Take a quick look at the data set using <code>Vew()</code> and briefly summarize what data is contained in this data set. Be specific.</p>
<p>Plot the change in ice extent over time as a line plot. Chose a theme. Add a linear regression and confidence interval. Bonus: Change the default colors of the regression line and the confidence interval.</p>
<p>Comment each line of your ggplot code (you can add comments between the lines or at the end), remember to caption your figure, list your data source and and label your axis in a meaningful way.</p>
<p>Write a short description of your figure summarizing the key results displayed.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:Vis-" class="question">
<p class="question-begin">
► Question 1
</p>
<div class="question-body">
<p>One more data set. This one is from the NOAA Hurricane Research Division. While interpreting the observed patterns in sea level and ice extent and modeling future projections is pretty straightforward. For this coding challenge you will need to combine your data wrangling and visualization skills!</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="visualization.html#cb38-1"></a>hurricane &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">"data/hurricanes.txt"</span>, <span class="dt">delim =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span></code></pre></div>
<p>Take a quick look at the data set using <code>Vew()</code> and briefly summarize what data is contained in this data set. Be specific<label for="tufte-sn-12" class="margin-toggle sidenote-number">12</label><input type="checkbox" id="tufte-sn-12" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">12</span> Note, several of the columns start with ‘Revised’ this just has to do with the entire data set having revised (most recent) definitions applied for the metrics included. You can ignore that component.</span>.</p>
<p>When thinking about hurricanes there are two metrics to consider when determining whether or not “hurricanes have gotten worse”. First we can look at whether or not hurricanes have become more common by plotting the number of hurricanes for each year. Create a faceted plot with individual line plots showing the number of named storms (this would include not only hurricanes put also tropical storms), the number of hurricanes, the number of major hurricanes, and the number of hurricanes in the United States. Add a linear regression. Chose a custom theme.</p>
<p>You will have to reformat the data set in order to plot it in this fashion. It can be helpful to first think about what your <code>ggplot</code> code should look like to create the plot described above and then format your data set to fit those needs<label for="tufte-sn-13" class="margin-toggle sidenote-number">13</label><input type="checkbox" id="tufte-sn-13" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">13</span> Recall that ggplot is designed not only around the grammar of graphics but also the principles of tidy data… do we currently have a tidy data set?</span>.</p>
<p>Bonus: We’ve previously used <code>facet_grid()</code> to create faceted plots which requires us to specify how panels should be laid out in rows and/or columns. Figure out how to use <code>facet_wrap()</code> to just specify which variable to use to create individual panels with out them all needing to be laid out next to each other in columns or underneath each other in rows.</p>
<p>The other way to evaluate whether or not “hurricanes have gotten worse” is to not look at the number of storms but to determine whether individual storms or storms as a whole have become more intense and/or destructive.</p>
<p>The one column you probably have not yet been able to figure out is the column containing information on the “accumulated cyclone energy”<label for="tufte-sn-14" class="margin-toggle sidenote-number">14</label><input type="checkbox" id="tufte-sn-14" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">14</span> Now that you have this information if you have not already add it to your short data set description.</span>.</p>
<p>Create a bar plot showing the ACE for each year. Chose a theme and customize the color of your bars<label for="tufte-sn-15" class="margin-toggle sidenote-number">15</label><input type="checkbox" id="tufte-sn-15" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">15</span> You can specify color and fill for bar plots. Try setting the color and fill to the same and to different colors to see what happens when you have a bar plot with this many individual bars.</span></p>
<p>Bonus: Tru to figure out how to use <code>geom_hline()</code> to add a horizontal line indicating the mean ACE for the recorded time period.</p>
<p>For all the plots, comment each line of your ggplot code (you can add comments between the lines or at the end), remember to caption your figure, list your data source and and label your axis in a meaningful way.</p>
<p>Write a short description for each figure summarizing the key results displayed and argue whether or not you thing “hurricanes have gotten worse”.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:Vis-" class="question">
<p class="question-begin">
► Question 1
</p>
<div class="question-body">
<p>Choose five of the plots we have generated in this channel and combine them into a single plot using <code>patchwork</code>; include at least two columns and two rows in your layout.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>

</div>
</div></body></html>

<p style="text-align: center;">
<a href="climate-change.html"><button class="btn btn-default">Previous</button></a>
</p>
<p class="build-date">Page built: 
2021-09-18
 using 
R version 4.0.2 (2020-06-22)
</p>
</div>
</div>



</body>
</html>
